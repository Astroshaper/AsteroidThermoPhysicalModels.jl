<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Physical model · AsteroidThermoPhysicalModels.jl</title><meta name="title" content="Physical model · AsteroidThermoPhysicalModels.jl"/><meta property="og:title" content="Physical model · AsteroidThermoPhysicalModels.jl"/><meta property="twitter:title" content="Physical model · AsteroidThermoPhysicalModels.jl"/><meta name="description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="twitter:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/physical_model/"/><meta property="twitter:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/physical_model/"/><link rel="canonical" href="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/physical_model/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AsteroidThermoPhysicalModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Physical model</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Symbols"><span>Symbols</span></a></li><li><a class="tocitem" href="#Heat-Conduction-Equation"><span>Heat Conduction Equation</span></a></li><li><a class="tocitem" href="#Thermal-Inertia"><span>Thermal Inertia</span></a></li><li><a class="tocitem" href="#Thermal-Skin-Depth"><span>Thermal Skin Depth</span></a></li><li><a class="tocitem" href="#Non-Gravitational-Effects"><span>Non-Gravitational Effects</span></a></li><li><a class="tocitem" href="#Binary-Asteroid-Systems"><span>Binary Asteroid Systems</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Usage Examples</a></li><li><a class="tocitem" href="../benchmarks/">Performance</a></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Physical model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Physical model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/main/docs/src/physical_model.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Physical-Model"><a class="docs-heading-anchor" href="#Physical-Model">Physical Model</a><a id="Physical-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Model" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p><code>AsteroidThermoPhysicalModels.jl</code> is a comprehensive toolkit for thermophysical modeling of asteroids. This package allows you to simulate the temperature distribution on an asteroid, and predict the non-gravitational force (i.e., Yarkovsky and YORP effects).</p><p>The thermophysical model (TPM) considers the following physical processes:</p><ol><li><strong>Heat Conduction</strong>: Solves a one-dimensional heat conduction equation to model heat transfer from the surface into the interior of the asteroid.</li><li><strong>Self-Shadowing</strong>: Accounts for local shadows cast by topography.</li><li><strong>Self-Heating</strong>: Considers re-absorption of scattered light and thermal radiation from surrounding surfaces.</li><li><strong>Mutual Shadowing</strong>: For a binary asteroid, accounts for eclipses between the primary and secondary bodies.</li><li><strong>Mutual Heating</strong>: For a binary asteroid, considers thermal exchange between the primary and secondary bodies.</li></ol><h2 id="Symbols"><a class="docs-heading-anchor" href="#Symbols">Symbols</a><a id="Symbols-1"></a><a class="docs-heading-anchor-permalink" href="#Symbols" title="Permalink"></a></h2><p>The following symbols are used throughout the package to represent various physical quantities:</p><table><tr><th style="text-align: left">Symbol</th><th style="text-align: left">Unit</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><span>$t$</span></td><td style="text-align: left"><span>$[\mathrm{s}]$</span></td><td style="text-align: left">Time</td></tr><tr><td style="text-align: left"><span>$T$</span></td><td style="text-align: left"><span>$[\mathrm{K}]$</span></td><td style="text-align: left">Temperature</td></tr><tr><td style="text-align: left"><span>$R_\text{vis}$</span></td><td style="text-align: left"><span>$[\text{-}]$</span></td><td style="text-align: left">Reflectance for visible light</td></tr><tr><td style="text-align: left"><span>$R_\text{ir}$</span></td><td style="text-align: left"><span>$[\text{-}]$</span></td><td style="text-align: left">Reflectance for thermal infrared</td></tr><tr><td style="text-align: left"><span>$F_\text{sun}$</span></td><td style="text-align: left"><span>$[\mathrm{W/m^2}]$</span></td><td style="text-align: left">Flux of direct sunlight</td></tr><tr><td style="text-align: left"><span>$F_\text{scat}$</span></td><td style="text-align: left"><span>$[\mathrm{W/m^2}]$</span></td><td style="text-align: left">Flux of scattered light</td></tr><tr><td style="text-align: left"><span>$F_\text{rad}$</span></td><td style="text-align: left"><span>$[\mathrm{W/m^2}]$</span></td><td style="text-align: left">Flux of thermal radiation from surrounding surface</td></tr><tr><td style="text-align: left"><span>$\rho$</span></td><td style="text-align: left"><span>$[\mathrm{kg/m^3}]$</span></td><td style="text-align: left">Density</td></tr><tr><td style="text-align: left"><span>$C_p$</span></td><td style="text-align: left"><span>$[\mathrm{J/K}]$</span></td><td style="text-align: left">Heat capacity at constant pressure</td></tr><tr><td style="text-align: left"><span>$P$</span></td><td style="text-align: left"><span>$[\mathrm{s}]$</span></td><td style="text-align: left">Rotation period</td></tr><tr><td style="text-align: left"><span>$l$</span></td><td style="text-align: left"><span>$[\mathrm{m}]$</span></td><td style="text-align: left">Thermal skin depth</td></tr><tr><td style="text-align: left"><span>$k$</span></td><td style="text-align: left"><span>$[\mathrm{W/(m \cdot K)}]$</span></td><td style="text-align: left">Thermal conductivity</td></tr><tr><td style="text-align: left"><span>$z$</span></td><td style="text-align: left"><span>$[\mathrm{m}]$</span></td><td style="text-align: left">Depth</td></tr><tr><td style="text-align: left"><span>$E$</span></td><td style="text-align: left"><span>$[\mathrm{J}]$</span></td><td style="text-align: left">Emittance energy</td></tr><tr><td style="text-align: left"><span>$\Gamma$</span></td><td style="text-align: left"><span>$[\mathrm{tiu}] = [\mathrm{J \cdot m^{-2} \cdot K^{-1} \cdot s^{-1/2}}]$</span></td><td style="text-align: left">Thermal inertia (cf. <a href="https://nathaniel.putzig.com/research/tiu.html">Thermal inertia SI unit proposal</a>)</td></tr><tr><td style="text-align: left"><span>$\varepsilon$</span></td><td style="text-align: left"><span>$[\text{-}]$</span></td><td style="text-align: left">Emissivity</td></tr><tr><td style="text-align: left"><span>$\Phi$</span></td><td style="text-align: left"><span>$[\mathrm{W/m^2}]$</span></td><td style="text-align: left">Solar energy flux</td></tr><tr><td style="text-align: left"><span>$\sigma_\text{SB}$</span></td><td style="text-align: left"><span>$[\mathrm{W/(m^2 \cdot K^4)}]$</span></td><td style="text-align: left">Stefan-Boltzmann constant</td></tr></table><h2 id="Heat-Conduction-Equation"><a class="docs-heading-anchor" href="#Heat-Conduction-Equation">Heat Conduction Equation</a><a id="Heat-Conduction-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Heat-Conduction-Equation" title="Permalink"></a></h2><p>Heat conduction within the asteroid is modeled by the following one-dimensional heat diffusion equation:</p><p class="math-container">\[\rho C_p \frac{\partial T}{\partial t} = k \frac{\partial^2 T}{\partial z^2}\]</p><p>where:</p><ul><li><span>$T(z,t)$</span> is the temperature at depth <span>$z$</span> and time <span>$t$</span></li><li><span>$\rho$</span> is the density</li><li><span>$C_p$</span> is the specific heat capacity at constant pressure</li><li><span>$k$</span> is the thermal conductivity</li></ul><h3 id="Numerical-Solvers"><a class="docs-heading-anchor" href="#Numerical-Solvers">Numerical Solvers</a><a id="Numerical-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Solvers" title="Permalink"></a></h3><p><code>AsteroidThermoPhysicalModels.jl</code> provides three numerical methods to solve the heat conduction equation:</p><ol><li><p><strong>Explicit Euler Method</strong> (<code>ExplicitEulerSolver</code>)</p><ul><li>Forward difference in time</li><li>Conditionally stable: requires <span>$\lambda = \alpha \Delta t / \Delta z^2 &lt; 0.5$</span></li><li>First-order accurate in time</li><li>Fast for small time steps</li></ul></li><li><p><strong>Implicit Euler Method</strong> (<code>ImplicitEulerSolver</code>)</p><ul><li>Backward difference in time</li><li>Unconditionally stable for any time step</li><li>First-order accurate in time</li><li>Requires solving a tridiagonal system</li></ul></li><li><p><strong>Crank-Nicolson Method</strong> (<code>CrankNicolsonSolver</code>)</p><ul><li>Average of forward and backward differences</li><li>Unconditionally stable</li><li>Second-order accurate in both time and space</li><li>Best balance of accuracy and stability</li></ul></li></ol><p>The solver can be specified when creating the thermophysical model:</p><pre><code class="language-julia hljs"># Example: Using Crank-Nicolson solver
stpm = SingleAsteroidTPM(shape, thermo_params;
   SELF_SHADOWING = true,
   SELF_HEATING   = true,
   SOLVER         = AsteroidThermoPhysicalModels.CrankNicolsonSolver(thermo_params),
   BC_UPPER       = AsteroidThermoPhysicalModels.RadiationBoundaryCondition(),
   BC_LOWER       = AsteroidThermoPhysicalModels.InsulationBoundaryCondition(),
)</code></pre><h3 id="Boundary-Conditions"><a class="docs-heading-anchor" href="#Boundary-Conditions">Boundary Conditions</a><a id="Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions" title="Permalink"></a></h3><h4 id="Upper-Boundary-Condition-(Surface)"><a class="docs-heading-anchor" href="#Upper-Boundary-Condition-(Surface)">Upper Boundary Condition (Surface)</a><a id="Upper-Boundary-Condition-(Surface)-1"></a><a class="docs-heading-anchor-permalink" href="#Upper-Boundary-Condition-(Surface)" title="Permalink"></a></h4><p>At the surface, a radiative equilibrium boundary condition is applied:</p><p class="math-container">\[-k \frac{\partial T}{\partial z}\bigg|_{z=0} = (1-R_\text{vis})(F_\text{sun} + F_\text{scat}) + (1-R_\text{ir})F_\text{rad} - \varepsilon \sigma T^4\]</p><p>where:</p><ul><li>The left side represents the heat flux from the surface into the interior</li><li>The right side represents the energy balance at the surface (absorbed solar radiation, scattered light, and thermal radiation minus emitted thermal radiation)</li></ul><h4 id="Lower-Boundary-Condition"><a class="docs-heading-anchor" href="#Lower-Boundary-Condition">Lower Boundary Condition</a><a id="Lower-Boundary-Condition-1"></a><a class="docs-heading-anchor-permalink" href="#Lower-Boundary-Condition" title="Permalink"></a></h4><p>At the lower boundary, an insulation condition is typically applied:</p><p class="math-container">\[\frac{\partial T}{\partial z}\bigg|_{z=z_\text{max}} = 0\]</p><h2 id="Thermal-Inertia"><a class="docs-heading-anchor" href="#Thermal-Inertia">Thermal Inertia</a><a id="Thermal-Inertia-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-Inertia" title="Permalink"></a></h2><p>Thermal inertia is a physical quantity that represents the ability of a material to resist temperature changes, defined by:</p><p class="math-container">\[\Gamma = \sqrt{k \rho C_p}\]</p><p>The unit is <code>tiu</code> (thermal inertia unit) or <code>J·m⁻²·K⁻¹·s⁻¹/²</code>.</p><h2 id="Thermal-Skin-Depth"><a class="docs-heading-anchor" href="#Thermal-Skin-Depth">Thermal Skin Depth</a><a id="Thermal-Skin-Depth-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-Skin-Depth" title="Permalink"></a></h2><p>The thermal skin depth is a characteristic length that represents how far a periodic thermal wave penetrates into a material:</p><p class="math-container">\[l = \sqrt{\frac{4\pi P k}{\rho C_p}}\]</p><p>where <span>$P$</span> is the period of the thermal cycle (typically the rotation period of the asteroid).</p><h2 id="Non-Gravitational-Effects"><a class="docs-heading-anchor" href="#Non-Gravitational-Effects">Non-Gravitational Effects</a><a id="Non-Gravitational-Effects-1"></a><a class="docs-heading-anchor-permalink" href="#Non-Gravitational-Effects" title="Permalink"></a></h2><h3 id="Yarkovsky-Effect"><a class="docs-heading-anchor" href="#Yarkovsky-Effect">Yarkovsky Effect</a><a id="Yarkovsky-Effect-1"></a><a class="docs-heading-anchor-permalink" href="#Yarkovsky-Effect" title="Permalink"></a></h3><p>The Yarkovsky effect is an orbital perturbation caused by the asymmetric thermal emission resulting from the day-night temperature difference due to the asteroid&#39;s rotation. This effect primarily affects the semi-major axis of the asteroid&#39;s orbit.</p><h3 id="YORP-Effect"><a class="docs-heading-anchor" href="#YORP-Effect">YORP Effect</a><a id="YORP-Effect-1"></a><a class="docs-heading-anchor-permalink" href="#YORP-Effect" title="Permalink"></a></h3><p>The YORP effect (Yarkovsky-O&#39;Keefe-Radzievskii-Paddack effect) is a rotational perturbation resulting from thermal emission due to the asymmetric shape of the asteroid. This effect influences the rotation rate and the orientation of the asteroid&#39;s spin axis.</p><h2 id="Binary-Asteroid-Systems"><a class="docs-heading-anchor" href="#Binary-Asteroid-Systems">Binary Asteroid Systems</a><a id="Binary-Asteroid-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Binary-Asteroid-Systems" title="Permalink"></a></h2><p>For binary asteroid systems, <code>AsteroidThermoPhysicalModels.jl</code> provides comprehensive modeling of thermal interactions between the primary and secondary bodies.</p><h3 id="Coordinate-Systems"><a class="docs-heading-anchor" href="#Coordinate-Systems">Coordinate Systems</a><a id="Coordinate-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Coordinate-Systems" title="Permalink"></a></h3><p>The package uses the following coordinate conventions:</p><ul><li><strong>Primary-fixed frame</strong>: The reference frame fixed to the primary body</li><li><strong>Secondary-fixed frame</strong>: The reference frame fixed to the secondary body</li><li><strong>r₁₂</strong>: Position vector from primary to secondary in the primary-fixed frame</li><li><strong>R₁₂</strong>: Rotation matrix from primary to secondary frame</li><li><strong>R₂₁ = R₁₂ᵀ</strong>: Rotation matrix from secondary to primary frame</li></ul><h3 id="Coordinate-Transformations"><a class="docs-heading-anchor" href="#Coordinate-Transformations">Coordinate Transformations</a><a id="Coordinate-Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Coordinate-Transformations" title="Permalink"></a></h3><p>For binary systems, coordinate transformations are handled automatically by the unified API:</p><pre><code class="language-julia hljs"># The unified API handles all transformations internally
update_flux_all!(btpm, r☉₁, r₁₂, R₁₂)</code></pre><p>The package internally computes:</p><ul><li>Sun position in secondary frame: <code>r☉₂ = R₁₂ * (r☉₁ - r₁₂)</code></li><li>Primary position in secondary frame: <code>r₂₁ = -R₁₂ * r₁₂</code></li></ul><p>These transformations ensure accurate calculation of mutual shadowing and heating effects.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../examples/">Usage Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 21 July 2025 13:32">Monday 21 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
