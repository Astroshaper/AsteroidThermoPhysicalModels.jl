<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · AsteroidThermoPhysicalModels.jl</title><meta name="title" content="API Reference · AsteroidThermoPhysicalModels.jl"/><meta property="og:title" content="API Reference · AsteroidThermoPhysicalModels.jl"/><meta property="twitter:title" content="API Reference · AsteroidThermoPhysicalModels.jl"/><meta name="description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="twitter:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><meta property="twitter:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><link rel="canonical" href="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AsteroidThermoPhysicalModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../physical_model/">Physical model</a></li><li><a class="tocitem" href="../examples/">Usage Examples</a></li><li><a class="tocitem" href="../benchmarks/">Performance</a></li><li class="is-active"><a class="tocitem" href>API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><p>This section provides the API reference of <code>AsteroidThermoPhysicalModels.jl</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.AbstractAsteroidThermoPhysicalModel" href="#AsteroidThermoPhysicalModels.AbstractAsteroidThermoPhysicalModel"><code>AsteroidThermoPhysicalModels.AbstractAsteroidThermoPhysicalModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of an asteroid&#39;s thermophysical model. The <code>AbstractAsteroidTPM</code> type is an alias for <code>AbstractAsteroidThermoPhysicalModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L114-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel" href="#AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel"><code>AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BinaryAsteroidThermoPhysicalModel{M1, M2} &lt;: AbstractAsteroidThermoPhysicalModel</code></pre><p><strong>Fields</strong></p><ul><li><code>pri</code>              : TPM for the primary</li><li><code>sec</code>              : TPM for the secondary</li><li><code>MUTUAL_SHADOWING</code> : Flag to consider mutual shadowing</li><li><code>MUTUAL_HEATING</code>   : Flag to consider mutual heating</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L262-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BinaryAsteroidThermoPhysicalModel(pri, sec; MUTUAL_SHADOWING, MUTUAL_HEATING) -&gt; btpm</code></pre><p>Construct a thermophysical model for a binary asteroid (<code>BinaryAsteroidThermoPhysicalModel</code>).</p><p><strong>Arguments</strong></p><ul><li><code>pri</code> : TPM for the primary asteroid</li><li><code>sec</code> : TPM for the secondary asteroid</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>MUTUAL_SHADOWING</code> : Flag to consider mutual shadowing (required)</li><li><code>MUTUAL_HEATING</code>   : Flag to consider mutual heating (required)</li></ul><p><strong>Notes</strong></p><ul><li>Both <code>MUTUAL_SHADOWING</code> and <code>MUTUAL_HEATING</code> must be explicitly specified</li><li>If <code>MUTUAL_SHADOWING</code> is true and BVH is not built, it will be automatically built</li><li>This may take some time for large shape models</li><li>To avoid automatic BVH building, pre-build with <code>build_bvh!</code> or load shapes with <code>with_bvh=true</code></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Explicit specification required
btpm = BinaryAsteroidThermoPhysicalModel(pri, sec; 
    MUTUAL_SHADOWING = true,
    MUTUAL_HEATING   = true,
)

# Or disable mutual effects
btpm = BinaryAsteroidThermoPhysicalModel(pri, sec; 
    MUTUAL_SHADOWING = false,
    MUTUAL_HEATING   = false,
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L280-L313">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult" href="#AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult"><code>AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BinaryAsteroidThermoPhysicalModelResult</code></pre><p>Output data format for <code>BinaryAsteroidThermoPhysicalModel</code></p><p><strong>Fields</strong></p><ul><li><code>pri</code> : TPM result for the primary</li><li><code>sec</code> : TPM result for the secondary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L447-L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Outer constructor of <code>BinaryAsteroidThermoPhysicalModelResult</code></p><p><strong>Arguments</strong></p><ul><li><code>btpm</code>          : Thermophysical model for a binary asteroid</li><li><code>ephem</code>         : Ephemerides</li><li><code>times_to_save</code> : Timesteps to save temperature (Common to both the primary and the secondary)</li><li><code>face_ID_pri</code>   : Face indices to save subsurface temperature of the primary</li><li><code>face_ID_sec</code>   : Face indices to save subsurface temperature of the secondary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L462-L471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BoundaryCondition" href="#AsteroidThermoPhysicalModels.BoundaryCondition"><code>AsteroidThermoPhysicalModels.BoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of a boundary condition for a heat conduction equation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L83-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.CrankNicolsonSolver" href="#AsteroidThermoPhysicalModels.CrankNicolsonSolver"><code>AsteroidThermoPhysicalModels.CrankNicolsonSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the Crank-Nicolson method:</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>Second order in time</li></ul><p>The <code>CrankNicolsonSolver</code> type has vectors for the tridiagonal matrix algorithm.</p><p><strong>References</strong></p><ul><li>https://en.wikipedia.org/wiki/Crank–Nicolson_method</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L57-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ExplicitEulerSolver" href="#AsteroidThermoPhysicalModels.ExplicitEulerSolver"><code>AsteroidThermoPhysicalModels.ExplicitEulerSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the explicit (forward) Euler method:</p><ul><li>Explicit in time</li><li>First order in time</li></ul><p>The <code>ExplicitEulerSolver</code> type includes a vector for the temperature at the next time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L23-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.HeatConductionSolver" href="#AsteroidThermoPhysicalModels.HeatConductionSolver"><code>AsteroidThermoPhysicalModels.HeatConductionSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of a solver for a heat conduction equation </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L17-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ImplicitEulerSolver" href="#AsteroidThermoPhysicalModels.ImplicitEulerSolver"><code>AsteroidThermoPhysicalModels.ImplicitEulerSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the implicit (backward) Euler method:</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>First order in time</li></ul><p>The <code>ImplicitEulerSolver</code> type has vectors for the tridiagonal matrix algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L38-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.InsulationBoundaryCondition" href="#AsteroidThermoPhysicalModels.InsulationBoundaryCondition"><code>AsteroidThermoPhysicalModels.InsulationBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singleton type of insulation boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L95-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.IsothermalBoundaryCondition" href="#AsteroidThermoPhysicalModels.IsothermalBoundaryCondition"><code>AsteroidThermoPhysicalModels.IsothermalBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of isothermal boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L101-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.RadiationBoundaryCondition" href="#AsteroidThermoPhysicalModels.RadiationBoundaryCondition"><code>AsteroidThermoPhysicalModels.RadiationBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singleton type of radiation boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L89-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel" href="#AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel"><code>AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SingleAsteroidThermoPhysicalModel &lt;: AbstractAsteroidThermoPhysicalModel</code></pre><p><strong>Fields</strong></p><ul><li><p><code>shape</code>         : Shape model</p></li><li><p><code>thermo_params</code> : Thermophysical parameters</p></li><li><p><code>illuminated_faces</code> : Boolean array indicating illumination state for each face (used for batch processing with AsteroidShapeModels.jl v0.4.0+)</p></li><li><p><code>flux_sun</code>          : Flux of direct sunlight on each face [W/m²]</p></li><li><p><code>flux_scat</code>         : Flux of scattered light on each face [W/m²]</p></li><li><p><code>flux_rad</code>          : Flux of thermal emission from surrounding surface on each face [W/m²]</p></li><li><p><code>temperature</code>       : Temperature matrix <code>(n_depth, n_face)</code> according to the number of depth cells <code>n_depth</code> and the number of faces <code>n_face</code>.</p></li><li><p><code>face_forces</code> : Thermal force on each face</p></li><li><p><code>force</code>       : Thermal recoil force at body-fixed frame (Yarkovsky effect)</p></li><li><p><code>torque</code>      : Thermal recoil torque at body-fixed frame (YORP effect)</p></li><li><p><code>SELF_SHADOWING</code> : Flag to consider self-shadowing</p></li><li><p><code>SELF_HEATING</code>   : Flag to consider self-heating</p></li><li><p><code>SOLVER</code>         : Solver of heat conduction equation</p></li><li><p><code>BC_UPPER</code>       : Boundary condition at the upper boundary</p></li><li><p><code>BC_LOWER</code>       : Boundary condition at the lower boundary</p></li></ul><p><strong>TODO:</strong></p><ul><li>roughness_maps   ::ShapeModel[]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L165-L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SingleAsteroidThermoPhysicalModel(shape, thermo_params; SELF_SHADOWING=true, SELF_HEATING=true) -&gt; stpm</code></pre><p>Construct a thermophysical model for a single asteroid (<code>SingleAsteroidThermoPhysicalModel</code>).</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>          : Shape model</li><li><code>thermo_params</code>  : Thermophysical parameters</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>SELF_SHADOWING</code> : Flag to consider self-shadowing</li><li><code>SELF_HEATING</code>   : Flag to consider self-heating</li><li><code>SOLVER</code>         : Solver of heat conduction equation</li><li><code>BC_UPPER</code>       : Boundary condition at the upper boundary</li><li><code>BC_LOWER</code>       : Boundary condition at the lower boundary</li></ul><p><strong>Notes</strong></p><ul><li>If <code>SELF_SHADOWING</code> is true and face<em>visibility</em>graph is not built, it will be automatically built</li><li>This may take some time for large shape models</li><li>To avoid automatic building, pre-build with <code>build_face_visibility_graph!</code> or load shape with <code>with_face_visibility=true</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L213-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult" href="#AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult"><code>AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SingleAsteroidThermoPhysicalModelResult</code></pre><p>Output data format for <code>SingleAsteroidThermoPhysicalModel</code> </p><p><strong>Fields</strong></p><p><strong>Saved at all time steps</strong></p><ul><li><code>times</code>  : Timesteps, given the same vector as <code>ephem.time</code> [s]</li><li><code>E_in</code>   : Input energy per second on the whole surface [W]</li><li><code>E_out</code>  : Output energy per second from the whole surface [W]</li><li><code>force</code>  : Thermal force on the asteroid [N]</li><li><code>torque</code> : Thermal torque on the asteroid [N ⋅ m]</li></ul><p><strong>Saved only at the time steps desired by the user</strong></p><ul><li><code>times_to_save</code>          : Timesteps to save temperature and thermal force on every face [s]</li><li><code>depth_nodes</code>            : Depths of the calculation nodes for 1-D heat conduction [m], a vector of size <code>n_depth</code></li><li><code>surface_temperature</code>    : Surface temperature [K], a matrix in size of <code>(n_face, n_time)</code>.<ul><li><code>n_face</code> : Number of faces</li><li><code>n_time</code> : Number of time steps to save surface temperature</li></ul></li><li><code>subsurface_temperature</code> : Temperature [K] as a function of depth [m] and time [s], <code>Dict</code> with face ID as key and a matrix <code>(n_depth, n_time)</code> as an entry.<ul><li><code>n_depth</code> : The number of the depth nodes</li><li><code>n_time</code> : The number of time steps to save temperature</li></ul></li><li><code>face_forces</code>            : Thermal force on every face of the shape model [N], a matrix in size of <code>(n_face, n_time)</code>.<ul><li><code>n_face</code> : Number of faces</li><li><code>n_time</code> : Number of time steps to save surface temperature</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L365-L390">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult-Tuple{SingleAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult-Tuple{SingleAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Outer constructor of <code>SingleAsteroidThermoPhysicalModelResult</code></p><p><strong>Arguments</strong></p><ul><li><code>stpm</code>          : Thermophysical model for a single asteroid</li><li><code>ephem</code>         : Ephemerides</li><li><code>times_to_save</code> : Timesteps to save temperature</li><li><code>face_ID</code>       : Face indices to save subsurface temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L406-L414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ThermoParams" href="#AsteroidThermoPhysicalModels.ThermoParams"><code>AsteroidThermoPhysicalModels.ThermoParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ThermoParams</code></pre><p><strong>Fields</strong></p><ul><li><p><code>thermal_conductivity</code> : Vector of thermal conductivity for each facet [W/m/K]</p></li><li><p><code>density</code>              : Vector of density for each facet [kg/m³]</p></li><li><p><code>heat_capacity</code>        : Vector of heat capacity for each facet [J/kg/K]</p></li><li><p><code>reflectance_vis</code> : Vector of reflectance in visible light for each facet [-]</p></li><li><p><code>reflectance_ir</code>  : Vector of reflectance in thermal infrared for each facet [-]</p></li><li><p><code>emissivity</code>      : Vector of emissivity for each facet [-]</p></li><li><p><code>z_max</code>   : Depth of the lower boundary of a heat conduction equation [m]</p></li><li><p><code>Δz</code>      : Depth step width [m]</p></li><li><p><code>n_depth</code> : Number of depth steps</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermo_params.jl#L111-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ThermoParams-Tuple{Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64}" href="#AsteroidThermoPhysicalModels.ThermoParams-Tuple{Float64, Float64, Float64, Float64, Float64, Float64, Float64, Float64, Int64}"><code>AsteroidThermoPhysicalModels.ThermoParams</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ThermoParams(
    thermal_conductivity ::Float64,
    density              ::Float64,
    heat_capacity        ::Float64,
    reflectance_vis      ::Float64,
    reflectance_ir       ::Float64,
    emissivity           ::Float64,
    z_max                ::Float64,
    Δz                   ::Float64,
    n_depth              ::Int
)</code></pre><p>Outer constructor for <code>ThermoParams</code>. You can give the same parameters to all facets by <code>Float64</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>thermal_conductivity</code> : Thermal conductivity [W/m/K]</p></li><li><p><code>density</code>              : Density [kg/m³]</p></li><li><p><code>heat_capacity</code>        : Heat capacity [J/kg/K]</p></li><li><p><code>reflectance_vis</code> : Reflectance in visible light [-]</p></li><li><p><code>reflectance_ir</code>  : Reflectance in thermal infrared [-]</p></li><li><p><code>emissivity</code>      : Emissivity [-]</p></li><li><p><code>z_max</code>           : Depth of the lower boundary of a heat conduction equation [m]</p></li><li><p><code>Δz</code>              : Depth step width [m]</p></li><li><p><code>n_depth</code>         : Number of depth steps</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermo_params.jl#L142-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.absorbed_energy_flux-NTuple{5, Any}" href="#AsteroidThermoPhysicalModels.absorbed_energy_flux-NTuple{5, Any}"><code>AsteroidThermoPhysicalModels.absorbed_energy_flux</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">absorbed_energy_flux(R_vis, R_ir, F_sun, F_scat, F_rad) -&gt; F_abs</code></pre><p>Calculate the total energy flux absorbed by a surface element, accounting for wavelength-dependent reflectance properties.</p><p><strong>Arguments</strong></p><ul><li><code>R_vis::Real</code> : Reflectance for visible light [-], valid between 0 and 1.</li><li><code>R_ir::Real</code> : Reflectance for thermal infrared [-], valid between 0 and 1.</li><li><code>F_sun::Real</code> : Direct solar radiation flux [W/m²]</li><li><code>F_scat::Real</code> : Scattered sunlight flux from other surfaces [W/m²]</li><li><code>F_rad::Real</code> : Thermal radiation flux from surrounding surfaces [W/m²]</li></ul><p><strong>Returns</strong></p><ul><li><code>F_abs::Real</code> : Total absorbed energy flux [W/m²]</li></ul><p><strong>Mathematical Formula</strong></p><pre><code class="nohighlight hljs">F_abs = (1 - R_vis) × F_sun + (1 - R_vis) × F_scat + (1 - R_ir) × F_rad</code></pre><p><strong>Physical Interpretation</strong></p><p>The function accounts for different reflectance properties at different wavelengths:</p><ul><li>Solar radiation (F<em>sun) and scattered light (F</em>scat) are in the visible spectrum</li><li>Thermal radiation (F_rad) is in the infrared spectrum</li><li>The absorbed fraction is (1 - reflectance) for each component</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">R_vis = 0.1   # 10% reflectance in visible
R_ir = 0.05   # 5% reflectance in IR
F_sun = 1000.0   # Direct solar flux
F_scat = 50.0    # Scattered light
F_rad = 100.0    # Thermal radiation
F_abs = absorbed_energy_flux(R_vis, R_ir, F_sun, F_scat, F_rad)
# Returns: 0.9 × 1000 + 0.9 × 50 + 0.95 × 100 = 1040.0 W/m²</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L17-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.analytical_solution_isothermal-NTuple{4, Any}" href="#AsteroidThermoPhysicalModels.analytical_solution_isothermal-NTuple{4, Any}"><code>AsteroidThermoPhysicalModels.analytical_solution_isothermal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">analytical_solution_isothermal(x, t, L, α; n_max=100) -&gt; T</code></pre><p>Calculate the analytical solution of the 1D heat equation with isothermal boundary conditions.</p><ul><li>Equation: ∂T/∂t = α ∂²T/∂x²</li><li>Domain: 0 ≤ x ≤ L</li><li>Boundary conditions: T(0,t) = T(L,t) = 0</li><li>Initial condition: T₀(x) = x &lt; 0.5L ? 2x/L : 2(1 - x/L)  # Triangular profile as follows:       T₀       ^      1 |   ・       |  ・ ・       | ・   ・       |・     ・     0 +–-+–-+–&gt; x       0  L/2  L</li></ul><p>The solution is given by the Fourier series:     T(x, t) = Σ Bₙ * sin(nπx/L) * exp(-αn²π²t/L²) where Bₙ = (2/L) * ∫₀^L T₀(ξ) * sin(nπξ/L) dξ For the triangular initial condition, the coefficients can be calculated analytically:     Bₙ = (8/n²π²) * sin(nπ/2) only for odd <code>n</code>. The sum of even-<code>n</code> terms is zero due to symmetry.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>     : Position [m]</li><li><code>t</code>     : Time [s]</li><li><code>L</code>     : Length of the domain [m]</li><li><code>α</code>     : Thermal diffusivity [m²/s]</li><li><code>n_max</code> : Number of terms in the Fourier series</li></ul><p><strong>Returns</strong></p><ul><li><code>T</code>     : Temperature [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction_analytical.jl#L9-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.blackbody_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blackbody_radiance(λ, T) -&gt; L_λ</code></pre><p>Accroding to Planck&#39;s law, calculate the spectral intensity of blackbody radiation at wavelength <code>λ</code> and temperature <code>T</code>.</p><p><strong>Arguments</strong></p><ul><li><code>λ</code> : Wavelength [m]</li><li><code>T</code> : Temperature [K]</li></ul><p><strong>Return</strong></p><ul><li><code>L_λ</code> : Spectral radiance [W/m²/m/steradian]</li></ul><p>cf. https://github.com/JuliaAstro/Planck.jl/blob/main/src/Planck.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermal_radiation.jl#L9-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any}" href="#AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any}"><code>AsteroidThermoPhysicalModels.blackbody_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blackbody_radiance(T) -&gt; L</code></pre><p>According to Stefan-Boltzmann law, calculate the total radiance of blackbody radiation at temperature <code>T</code>, integrated over all wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>T</code> : Temperature [K]</li></ul><p><strong>Return</strong></p><ul><li><code>L</code> : Radiance [W/m²/steradian]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermal_radiation.jl#L26-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.broadcast_thermo_params!-Tuple{AsteroidThermoPhysicalModels.ThermoParams, AsteroidShapeModels.ShapeModel}" href="#AsteroidThermoPhysicalModels.broadcast_thermo_params!-Tuple{AsteroidThermoPhysicalModels.ThermoParams, AsteroidShapeModels.ShapeModel}"><code>AsteroidThermoPhysicalModels.broadcast_thermo_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">broadcast_thermo_params!(thermo_params::ThermoParams, shape::ShapeModel)</code></pre><p>Broadcast the thermophysical parameters to all faces if the values are uniform globally.</p><p><strong>Arguments</strong></p><ul><li><code>thermo_params</code> : Thermophysical parameters</li><li><code>shape</code>         : Shape model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L153-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.broadcast_thermo_params!-Tuple{AsteroidThermoPhysicalModels.ThermoParams, Int64}" href="#AsteroidThermoPhysicalModels.broadcast_thermo_params!-Tuple{AsteroidThermoPhysicalModels.ThermoParams, Int64}"><code>AsteroidThermoPhysicalModels.broadcast_thermo_params!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">broadcast_thermo_params!(thermo_params::ThermoParams, n_face::Int)</code></pre><p>Broadcast the thermophysical parameters to all faces if the values are uniform globally.</p><p><strong>Arguments</strong></p><ul><li><code>thermo_params</code> : Thermophysical parameters</li><li><code>n_face</code>        : Number of faces on the shape model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L121-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.concave_spherical_segment-NTuple{6, Real}" href="#AsteroidThermoPhysicalModels.concave_spherical_segment-NTuple{6, Real}"><code>AsteroidThermoPhysicalModels.concave_spherical_segment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concave_spherical_segment(r, h, xc, yc, x, y) -&gt; z</code></pre><p>Calculate the z-coordinate (depth) of a point on a concave spherical segment (crater).</p><p><strong>Arguments</strong></p><ul><li><code>r::Real</code> : Crater radius [m]</li><li><code>h::Real</code> : Crater depth [m]</li><li><code>xc::Real</code>: x-coordinate of crater center [m]</li><li><code>yc::Real</code>: y-coordinate of crater center [m]</li><li><code>x::Real</code> : x-coordinate where to calculate z [m]</li><li><code>y::Real</code> : y-coordinate where to calculate z [m]</li></ul><p><strong>Returns</strong></p><ul><li><code>z::Real</code>: Depth below the reference surface (negative value) [m]</li></ul><p><strong>Mathematical Model</strong></p><p>The crater is modeled as a spherical cap. For a point (x,y) within the crater:</p><p class="math-container">\[z = R - h - \sqrt{R^2 - d^2}\]</p><p>where:</p><ul><li><code>R</code> is the curvature radius calculated from <code>crater_curvature_radius(r, h)</code></li><li><code>d</code> is the distance from the crater center: <code>d = √((x-xc)² + (y-yc)²)</code></li><li><code>z = 0</code> outside the crater (when <code>d &gt; r</code>)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># A crater at (0.5, 0.5) with radius 0.2 and depth 0.05
z = concave_spherical_segment(0.2, 0.05, 0.5, 0.5, 0.6, 0.5)  # Point at crater rim</code></pre><p><strong>Notes</strong></p><ul><li>Returns <code>z ≤ 0</code> (crater is a depression)</li><li>Returns <code>z = 0</code> for points outside the crater</li><li>The reference surface is at <code>z = 0</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/roughness.jl#L51-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.concave_spherical_segment-Tuple{Real, Real}" href="#AsteroidThermoPhysicalModels.concave_spherical_segment-Tuple{Real, Real}"><code>AsteroidThermoPhysicalModels.concave_spherical_segment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concave_spherical_segment(r, h; Nx=2^5, Ny=2^5, xc=0.5, yc=0.5) -&gt; xs, ys, zs</code></pre><p>Generate a grid representation of a concave spherical segment (crater) on a unit square domain.</p><p><strong>Arguments</strong></p><ul><li><code>r::Real</code> : Crater radius (in normalized coordinates, 0-1)</li><li><code>h::Real</code> : Crater depth (in same units as radius)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>Nx::Integer=32</code>: Number of grid points in the x-direction</li><li><code>Ny::Integer=32</code>: Number of grid points in the y-direction</li><li><code>xc::Real=0.5</code>: x-coordinate of crater center (normalized, 0-1)</li><li><code>yc::Real=0.5</code>: y-coordinate of crater center (normalized, 0-1)</li></ul><p><strong>Returns</strong></p><ul><li><code>xs::LinRange</code>: x-coordinates of grid points (0 to 1)</li><li><code>ys::LinRange</code>: y-coordinates of grid points (0 to 1)</li><li><code>zs::Matrix</code>: z-coordinates (depths) at each grid point</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Create a crater grid with radius 0.3 and depth 0.1
xs, ys, zs = concave_spherical_segment(0.3, 0.1; Nx=64, Ny=64)

# Off-center crater
xs, ys, zs = concave_spherical_segment(0.2, 0.05; xc=0.3, yc=0.7)</code></pre><p><strong>Notes</strong></p><ul><li>The domain is normalized to [0,1] × [0,1]</li><li>The crater parameters should be scaled accordingly</li><li>Grid has (Nx+1) × (Ny+1) total points</li><li>Useful for generating synthetic rough surfaces</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/roughness.jl#L101-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.crank_nicolson!-Tuple{SingleAsteroidThermoPhysicalModel, Any}" href="#AsteroidThermoPhysicalModels.crank_nicolson!-Tuple{SingleAsteroidThermoPhysicalModel, Any}"><code>AsteroidThermoPhysicalModels.crank_nicolson!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crank_nicolson!(stpm::SingleAsteroidTPM, Δt)</code></pre><p>Solve the 1D heat conduction equation using the Crank-Nicolson method. This method combines the explicit and implicit Euler methods for improved accuracy.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>Δt::Real</code> : Time step [s]</li></ul><p><strong>Method Properties</strong></p><ul><li><strong>Time discretization</strong>: Semi-implicit (average of forward and backward differences)</li><li><strong>Accuracy</strong>: Second-order in both time and space</li><li><strong>Stability</strong>: Unconditionally stable for any time step size</li></ul><p><strong>Discretization</strong></p><p>The heat conduction equation ∂T/∂t = α∂²T/∂z² is discretized using the average of explicit and implicit schemes:</p><pre><code class="nohighlight hljs">T[i,n+1] - T[i,n] = (α∆t)/(2∆z²) × 
    [(T[i+1,n+1] - 2T[i,n+1] + T[i-1,n+1]) + (T[i+1,n] - 2T[i,n] + T[i-1,n])]</code></pre><p>This leads to a tridiagonal system:</p><pre><code class="nohighlight hljs">-rT[i-1,n+1] + (1+2r)T[i,n+1] - rT[i+1,n+1] = 
    rT[i-1,n] + (1-2r)T[i,n] + rT[i+1,n]</code></pre><p>where r = α∆t/(2∆z²)</p><p><strong>Advantages</strong></p><ul><li>Higher accuracy than both explicit and implicit Euler methods</li><li>Unconditionally stable</li><li>Optimal balance between accuracy and computational cost</li><li>Second-order accuracy in both time and space</li></ul><p><strong>Implementation Details</strong></p><p>The method requires solving a tridiagonal system at each time step, similar to the implicit Euler method but with a modified right-hand side that includes information from the current time step.</p><p><strong>See Also</strong></p><ul><li><code>tridiagonal_matrix_algorithm!</code> for the solution algorithm</li><li><code>implicit_euler!</code>, <code>explicit_euler!</code> for comparison with other methods</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L322-L365">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.crater_curvature_radius-Tuple{Real, Real}" href="#AsteroidThermoPhysicalModels.crater_curvature_radius-Tuple{Real, Real}"><code>AsteroidThermoPhysicalModels.crater_curvature_radius</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crater_curvature_radius(r, h) -&gt; R</code></pre><p>Calculate the curvature radius of a concave spherical segment (crater shape).</p><p><strong>Arguments</strong></p><ul><li><code>r::Real</code>: Crater radius [m]</li><li><code>h::Real</code>: Crater depth [m]</li></ul><p><strong>Returns</strong></p><ul><li><code>R::Real</code>: Curvature radius of the spherical cap [m]</li></ul><p><strong>Mathematical Formula</strong></p><p>The curvature radius <code>R</code> of a spherical cap is given by:</p><p class="math-container">\[R = \frac{r^2 + h^2}{2h}\]</p><p>where <code>r</code> is the crater rim radius and <code>h</code> is the crater depth.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs"># A crater with 10m radius and 2m depth
R = crater_curvature_radius(10.0, 2.0)  # Returns 26.0</code></pre><p><strong>Notes</strong></p><ul><li>The crater is modeled as a spherical cap (portion of a sphere)</li><li>Larger R values correspond to shallower craters</li><li>As h → 0, R → ∞ (flat surface)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/roughness.jl#L19-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.energy_in-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.energy_in-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.energy_in</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_in(stpm::SingleAsteroidTPM) -&gt; E_in</code></pre><p>Calculate the total energy input rate (power) absorbed by the entire asteroid surface.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Returns</strong></p><ul><li><code>E_in::Float64</code> : Total absorbed power [W]</li></ul><p><strong>Calculation</strong></p><p>Integrates the absorbed energy flux over all surface facets:</p><pre><code class="nohighlight hljs">E_in = Σᵢ F_abs,ᵢ × Aᵢ</code></pre><p>where:</p><ul><li>F<em>abs,ᵢ is the absorbed energy flux on facet i (calculated by `absorbed</em>energy_flux`)</li><li>Aᵢ is the area of facet i</li></ul><p><strong>Components</strong></p><p>The absorbed energy includes:</p><ol><li>Direct solar radiation</li><li>Scattered light from other facets (if self-heating is enabled)</li><li>Thermal radiation from other facets (if self-heating is enabled)</li></ol><p><strong>Usage</strong></p><p>This function is typically used to check energy conservation in the model by comparing with <code>energy_out</code>.</p><p><strong>See Also</strong></p><ul><li><code>energy_out</code> for the total emitted power</li><li><code>absorbed_energy_flux</code> for the flux calculation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L58-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.energy_out-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.energy_out-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.energy_out</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_out(stpm::SingleAsteroidTPM) -&gt; E_out</code></pre><p>Calculate the total energy output rate (power) emitted by the entire asteroid surface through thermal radiation.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Returns</strong></p><ul><li><code>E_out::Float64</code> : Total emitted power [W]</li></ul><p><strong>Calculation</strong></p><p>Integrates the thermal emission over all surface facets using the Stefan-Boltzmann law:</p><pre><code class="nohighlight hljs">E_out = Σᵢ εᵢ × σ × Tᵢ⁴ × Aᵢ</code></pre><p>where:</p><ul><li>εᵢ is the emissivity of facet i</li><li>σ is the Stefan-Boltzmann constant (5.67×10⁻⁸ W/m²/K⁴)</li><li>Tᵢ is the surface temperature of facet i [K]</li><li>Aᵢ is the area of facet i [m²]</li></ul><p><strong>Energy Conservation</strong></p><p>In thermal equilibrium, E<em>out should approximately equal E</em>in (from <code>energy_in</code>). The ratio E<em>out/E</em>in is often used as a convergence criterion in thermophysical models.</p><p><strong>See Also</strong></p><ul><li><code>energy_in</code> for the total absorbed power</li><li><code>update_thermal_force!</code> for thermal recoil effects from this emission</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L108-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.explicit_euler!-Tuple{SingleAsteroidThermoPhysicalModel, Any}" href="#AsteroidThermoPhysicalModels.explicit_euler!-Tuple{SingleAsteroidThermoPhysicalModel, Any}"><code>AsteroidThermoPhysicalModels.explicit_euler!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">explicit_euler!(stpm::SingleAsteroidTPM, Δt)</code></pre><p>Solve the 1D heat conduction equation using the explicit (forward) Euler method. This method is conditionally stable and requires careful time step selection.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>Δt::Real</code> : Time step [s]</li></ul><p><strong>Method Properties</strong></p><ul><li><strong>Time discretization</strong>: Explicit (forward difference)</li><li><strong>Accuracy</strong>: First-order in time, second-order in space</li><li><strong>Stability</strong>: Conditionally stable, requires λ = αΔt/Δz² &lt; 0.5</li></ul><p><strong>Discretization</strong></p><p>The heat conduction equation ∂T/∂t = α∂²T/∂z² is discretized as:</p><pre><code class="nohighlight hljs">T[i,n+1] = T[i,n] + λ(T[i+1,n] - 2T[i,n] + T[i-1,n])</code></pre><p>where:</p><ul><li>λ = αΔt/Δz² is the dimensionless time step</li><li>α = k/(ρCₚ) is the thermal diffusivity</li><li>n is the time index, i is the depth index</li></ul><p><strong>Stability Criterion</strong></p><p>The method is stable only when λ &lt; 0.5. If this condition is violated, an error is thrown.</p><p><strong>Boundary Conditions</strong></p><ul><li>Upper boundary: Determined by <code>update_upper_temperature!</code></li><li>Lower boundary: Determined by <code>update_lower_temperature!</code></li></ul><p><strong>Performance Notes</strong></p><ul><li>This method is simple and fast but requires small time steps for stability</li><li>Consider using implicit methods for larger time steps</li></ul><p><strong>Errors</strong></p><ul><li>Throws an error if λ ≥ 0.5 (stability violation)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L133-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult}" href="#AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult}"><code>AsteroidThermoPhysicalModels.export_TPM_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_TPM_results(dirpath, result::BinaryAsteroidThermoPhysicalModelResult)</code></pre><p>Export the result of <code>BinaryAsteroidThermoPhysicalModel</code> to CSV files.  The output files are saved in the following directory structure:</p><pre><code class="nohighlight hljs">dirpath
├── pri
│   ├── physical_quantities.csv
│   ├── subsurface_temperature.csv
│   ├── surface_temperature.csv
│   └── thermal_force.csv
└── sec
    ├── physical_quantities.csv
    ├── subsurface_temperature.csv
    ├── surface_temperature.csv
    └── thermal_force.csv</code></pre><p><strong>Arguments</strong></p><ul><li><code>dirpath</code> : Path to the directory to save CSV files.</li><li><code>result</code>  : Output data format for <code>BinaryAsteroidThermoPhysicalModel</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L612-L633">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult}" href="#AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult}"><code>AsteroidThermoPhysicalModels.export_TPM_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_TPM_results(dirpath, result::SingleAsteroidThermoPhysicalModelResult)</code></pre><p>Export the result of <code>SingleAsteroidThermoPhysicalModel</code> to CSV files.  The output files are saved in the following directory structure:</p><pre><code class="nohighlight hljs">dirpath
├── physical_quantities.csv
├── subsurface_temperature.csv
├── surface_temperature.csv
└── thermal_force.csv</code></pre><p><strong>Arguments</strong></p><ul><li><code>dirpath</code> : Path to the directory to save CSV files.</li><li><code>result</code>  : Output data format for <code>SingleAsteroidThermoPhysicalModel</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L529-L544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.implicit_euler!-Tuple{SingleAsteroidThermoPhysicalModel, Any}" href="#AsteroidThermoPhysicalModels.implicit_euler!-Tuple{SingleAsteroidThermoPhysicalModel, Any}"><code>AsteroidThermoPhysicalModels.implicit_euler!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">implicit_euler!(stpm::SingleAsteroidTPM, Δt)</code></pre><p>Solve the 1D heat conduction equation using the implicit (backward) Euler method. This method is unconditionally stable, allowing for larger time steps than explicit methods.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>Δt::Real</code> : Time step [s]</li></ul><p><strong>Method Properties</strong></p><ul><li><strong>Time discretization</strong>: Implicit (backward difference)</li><li><strong>Accuracy</strong>: First-order in time, second-order in space</li><li><strong>Stability</strong>: Unconditionally stable for any time step size</li></ul><p><strong>Discretization</strong></p><p>The heat conduction equation ∂T/∂t = α∂²T/∂z² is discretized as:</p><pre><code class="nohighlight hljs">T[i,n+1] - T[i,n] = λ(T[i+1,n+1] - 2T[i,n+1] + T[i-1,n+1])</code></pre><p>This leads to a tridiagonal system:</p><pre><code class="nohighlight hljs">-λT[i-1,n+1] + (1+2λ)T[i,n+1] - λT[i+1,n+1] = T[i,n]</code></pre><p>where λ = αΔt/Δz²</p><p><strong>Solution Method</strong></p><p>The resulting tridiagonal system is solved using the Thomas algorithm (tridiagonal matrix algorithm) for each face.</p><p><strong>Boundary Conditions</strong></p><p>Different boundary conditions modify the tridiagonal matrix:</p><ul><li><strong>Radiation BC</strong>: Special treatment after solving the system</li><li><strong>Insulation BC</strong>: Modified coefficients at boundaries</li><li><strong>Isothermal BC</strong>: Direct temperature assignment</li></ul><p><strong>Advantages</strong></p><ul><li>Unconditionally stable - no restriction on time step size</li><li>Allows for larger time steps compared to explicit methods</li><li>More computationally intensive per step but often faster overall</li></ul><p><strong>See Also</strong></p><ul><li><code>tridiagonal_matrix_algorithm!</code> for the solution algorithm</li><li><code>update_upper_temperature!</code>, <code>update_lower_temperature!</code> for boundary conditions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L200-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.init_temperature!-Tuple{BinaryAsteroidThermoPhysicalModel, Real}" href="#AsteroidThermoPhysicalModels.init_temperature!-Tuple{BinaryAsteroidThermoPhysicalModel, Real}"><code>AsteroidThermoPhysicalModels.init_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_temperature!(btpm::BinaryTBinaryAsteroidThermoPhysicalModelPM, T₀::Real)</code></pre><p>Initialize all temperature cells at the given temperature <code>T₀</code></p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>T₀</code>   : Initial temperature of all cells [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L705-L713">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.init_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Real}" href="#AsteroidThermoPhysicalModels.init_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Real}"><code>AsteroidThermoPhysicalModels.init_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_temperature!(stpm::SingleAsteroidThermoPhysicalModel, T₀::Real)</code></pre><p>Initialize all temperature cells at the given temperature <code>T₀</code></p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>T₀</code>   : Initial temperature of all cells [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L691-L699">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.mutual_heating!-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Any}" href="#AsteroidThermoPhysicalModels.mutual_heating!-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Any}"><code>AsteroidThermoPhysicalModels.mutual_heating!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutual_heating!(btpm::BinaryAsteroidTPM, r₁₂, R₂₁)</code></pre><p>Calculate the mutual heating between the primary and secondary asteroids.</p><p><strong>Arguments</strong></p><ul><li><code>btpm::BinaryAsteroidTPM</code> : Thermophysical model for a binary asteroid</li><li><code>r₁₂::StaticVector{3}</code>    : Position vector of secondary&#39;s center in primary&#39;s frame [m]</li><li><code>R₂₁::StaticMatrix{3,3}</code>  : Rotation matrix from secondary to primary frame</li></ul><p><strong>TODO</strong></p><ul><li>Need to consider local horizon?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L442-L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.run_TPM!-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.run_TPM!-Tuple{BinaryAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.run_TPM!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_TPM!(btpm::BinaryAsteroidThermoPhysicalModel, ephem, times_to_save, face_ID_pri, face_ID_sec; show_progress=true) -&gt; result</code></pre><p>Execute the thermophysical model simulation for a binary asteroid system over the specified time period.</p><p><strong>Arguments</strong></p><ul><li><code>btpm::BinaryAsteroidThermoPhysicalModel</code> : Thermophysical model for a binary asteroid</li><li><code>ephem</code> : Ephemerides data structure containing:<ul><li><code>time::Vector{Float64}</code>     : Time points for the simulation [s]</li><li><code>sun::Vector{SVector{3}}</code>   : Sun&#39;s position vectors in the primary&#39;s frame (NOT normalized) [m]</li><li><code>sec::Vector{SVector{3}}</code>   : Secondary&#39;s position vectors in the primary&#39;s frame [m]</li><li><code>P2S::Vector{SMatrix{3,3}}</code> : Rotation matrices from primary to secondary frames</li></ul></li><li><code>times_to_save::Vector{Float64}</code> : Specific time points at which to save detailed temperature data [s]</li><li><code>face_ID_pri::Vector{Int}</code> : Face indices for which to save subsurface temperature profiles for the primary</li><li><code>face_ID_sec::Vector{Int}</code> : Face indices for which to save subsurface temperature profiles for the secondary</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>show_progress::Bool=true</code> : Display progress meter during simulation</li></ul><p><strong>Returns</strong></p><ul><li><code>result::BinaryAsteroidThermoPhysicalModelResult</code> : Structure containing results for both components</li></ul><p><strong>Algorithm</strong></p><ol><li>For each time step:<ul><li>Update all energy fluxes using the unified API (solar+eclipse, scattered, thermal radiation, mutual heating)</li><li>Compute thermal forces and torques for both components</li><li>Save results if at a save point</li><li>Update temperature distribution for next time step</li></ul></li></ol><p><strong>Notes</strong></p><ul><li>Uses the unified <code>update_flux_all!</code> API which internally handles all coordinate transformations</li><li>Automatically respects all shadowing and heating flags (SELF<em>SHADOWING, SELF</em>HEATING, MUTUAL<em>SHADOWING, MUTUAL</em>HEATING)</li><li>Compatible with AsteroidShapeModels.jl v0.4.1 which fixes critical eclipse shadowing bugs</li></ul><p><strong>See Also</strong></p><ul><li><code>init_temperature!</code> to set initial conditions</li><li><code>export_TPM_results</code> to save results to files</li><li><code>update_flux_all!</code> for the unified flux update API</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L817-L855">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.run_TPM!-Tuple{SingleAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.run_TPM!-Tuple{SingleAsteroidThermoPhysicalModel, Any, Vector{Float64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.run_TPM!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_TPM!(stpm::SingleAsteroidThermoPhysicalModel, ephem, times_to_save, face_ID; show_progress=true) -&gt; result</code></pre><p>Execute the thermophysical model simulation for a single asteroid over the specified time period.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidThermoPhysicalModel</code> : Thermophysical model containing shape, thermal parameters, and state</li><li><code>ephem</code> : Ephemerides data structure containing:<ul><li><code>time::Vector{Float64}</code>   : Time points for the simulation [s]</li><li><code>sun::Vector{SVector{3}}</code> : Sun&#39;s position vectors in the asteroid-fixed frame (not normalized) [m]</li></ul></li><li><code>times_to_save::Vector{Float64}</code> : Specific time points at which to save detailed temperature data [s]</li><li><code>face_ID::Vector{Int}</code> : Face indices for which to save subsurface temperature profiles</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>show_progress::Bool=true</code> : Display progress meter during simulation</li></ul><p><strong>Returns</strong></p><ul><li><code>result::SingleAsteroidThermoPhysicalModelResult</code> : Structure containing:<ul><li>Time series of energy balance (E<em>in, E</em>out)</li><li>Thermal forces and torques at each time step</li><li>Surface temperatures at specified save times</li><li>Subsurface temperature profiles for selected faces</li></ul></li></ul><p><strong>Algorithm</strong></p><ol><li>For each time step:<ul><li>Update solar flux based on sun position</li><li>Calculate scattered light flux (if self-heating enabled)</li><li>Calculate thermal radiation flux (if self-heating enabled)</li><li>Compute thermal forces and torques</li><li>Save results if at a save point</li><li>Update temperature distribution for next step</li></ul></li></ol><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Setup ephemerides
ephem = (
    time = collect(0:60:86400),  # One day, 1-minute steps
    sun = [SVector(au2m, 0.0, 0.0) for _ in 1:1441]  # Sun at 1 AU
)

# Run simulation
times_to_save = [0.0, 21600.0, 43200.0, 64800.0, 86400.0]  # Every 6 hours
face_ID = [1, 100, 500]  # Save subsurface data for these faces
result = run_TPM!(stpm, ephem, times_to_save, face_ID)

# Check energy balance
println(&quot;Final E_out/E_in ratio: &quot;, result.E_out[end]/result.E_in[end])</code></pre><p><strong>Performance Notes</strong></p><ul><li>Computation time scales with number of faces and time steps</li><li>Self-shadowing and self-heating calculations add significant overhead</li></ul><p><strong>See Also</strong></p><ul><li><code>init_temperature!</code> to set initial conditions</li><li><code>export_TPM_results</code> to save results to files</li><li><code>update_temperature!</code> for the core temperature update algorithm</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L725-L782">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.subsolar_temperature-Tuple{Any, AsteroidThermoPhysicalModels.AbstractThermoParams}" href="#AsteroidThermoPhysicalModels.subsolar_temperature-Tuple{Any, AsteroidThermoPhysicalModels.AbstractThermoParams}"><code>AsteroidThermoPhysicalModels.subsolar_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subsolar_temperature(r☉, R_vis, ε) -&gt; Tₛₛ
subsolar_temperature(r☉, params::AbstractThermoParams) -&gt; Tₛₛ</code></pre><p>Calculate the subsolar temperature on an asteroid at a given heliocentric distance.</p><p><strong>Arguments</strong></p><ul><li><code>r☉::Vector</code>                   : Sun&#39;s position vector in the asteroid&#39;s fixed frame [m]</li><li><code>R_vis::Real</code>                  : Visible light reflectance (albedo) [-]</li><li><code>ε::Real</code>                      : Emissivity [-]</li><li><code>params::AbstractThermoParams</code> : Thermal parameters (alternative input)</li></ul><p><strong>Returns</strong></p><ul><li><code>Tₛₛ::Float64</code> : Subsolar point temperature [K]</li></ul><p><strong>Mathematical Formula</strong></p><p>Assuming radiative equilibrium with zero thermal conductivity (zero thermal inertia):</p><p class="math-container">\[T_{ss} = \left[\frac{(1 - R_{vis}) \Phi_\odot}{\varepsilon \sigma}\right]^{1/4}\]</p><p>where:</p><ul><li><span>$\Phi_\odot = \Phi_0 / r^2$</span> is the solar flux at distance r [au]</li><li><span>$\Phi_0 = 1366$</span> W/m² is the solar constant at 1 au</li><li><span>$\sigma$</span> is the Stefan-Boltzmann constant</li></ul><p><strong>Notes</strong></p><ul><li>This gives the maximum temperature for a non-rotating asteroid</li><li>Actual subsolar temperature may be lower due to thermal inertia</li><li>Valid for airless bodies with negligible heat conduction</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L651-L680">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.surface_temperature-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.surface_temperature-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.surface_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">surface_temperature(stpm::SingleAsteroidThermoPhysicalModel) -&gt; T_surface</code></pre><p>Extract the surface temperature values for all faces of the asteroid.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidThermoPhysicalModel</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Returns</strong></p><ul><li><code>T_surface::Vector{Float64}</code> : Surface temperature for each face [K]</li></ul><p><strong>Notes</strong></p><ul><li>Returns temperatures from the uppermost layer (index 1) of the temperature matrix</li><li>The length of the returned vector equals the number of faces in the shape model</li><li>Useful for visualization, thermal emission calculations, and analysis</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">T_surf = surface_temperature(stpm)
T_mean = mean(T_surf)  # Average surface temperature
T_max = maximum(T_surf)  # Hottest point
T_min = minimum(T_surf)  # Coldest point</code></pre><p><strong>See Also</strong></p><ul><li><code>stpm.temperature</code> for the full temperature matrix including subsurface</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L331-L357">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_diffusivity-Tuple{Any, Any, Any}" href="#AsteroidThermoPhysicalModels.thermal_diffusivity-Tuple{Any, Any, Any}"><code>AsteroidThermoPhysicalModels.thermal_diffusivity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_diffusivity(k, ρ, Cp) -&gt; α</code></pre><p>Calculate the thermal diffusivity of a material.</p><p><strong>Arguments</strong></p><ul><li><code>k::Real</code>  : Thermal conductivity [W/m/K]</li><li><code>ρ::Real</code>  : Material density [kg/m³]</li><li><code>Cₚ::Real</code> : Heat capacity [J/kg/K]</li></ul><p><strong>Returns</strong></p><ul><li><code>α::Real</code> : Thermal diffusivity [m²/s]</li></ul><p><strong>Mathematical Formula</strong></p><p class="math-container">\[\alpha = \frac{k}{\rho C_p}\]</p><p><strong>Physical Meaning</strong></p><ul><li>Measures how quickly temperature propagates through material</li><li>Appears in the heat diffusion equation: ∂T/∂t = α∇²T</li><li>High α: rapid heat diffusion</li><li>Low α: slow heat diffusion</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermo_params.jl#L78-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_inertia-Tuple{Any, Any, Any}" href="#AsteroidThermoPhysicalModels.thermal_inertia-Tuple{Any, Any, Any}"><code>AsteroidThermoPhysicalModels.thermal_inertia</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_inertia(k, ρ, Cp) -&gt; Γ</code></pre><p>Calculate the thermal inertia of a material.</p><p><strong>Arguments</strong></p><ul><li><code>k::Real</code>  : Thermal conductivity [W/m/K]</li><li><code>ρ::Real</code>  : Material density [kg/m³]</li><li><code>Cₚ::Real</code> : Heat capacity [J/kg/K]</li></ul><p><strong>Returns</strong></p><ul><li><code>Γ::Real</code> : Thermal inertia [J m⁻² K⁻¹ s⁻¹/²]</li></ul><p><strong>Mathematical Formula</strong></p><p class="math-container">\[\Gamma = \sqrt{k \rho C_p}\]</p><p><strong>Physical Meaning</strong></p><ul><li>Measures resistance to temperature change</li><li>High Γ: slow temperature response (rock-like)</li><li>Low Γ: rapid temperature response (dust-like)</li><li>Typical values: 50-2500 J m⁻² K⁻¹ s⁻¹/² for a planetary surface</li></ul><p><strong>Note</strong></p><p>The unit is sometimes called &quot;tiu&quot; (thermal inertia unit).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermo_params.jl#L48-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_radiance-Tuple{AsteroidShapeModels.ShapeModel, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, StaticArraysCore.StaticArray{Tuple{3}, &lt;:Real, 1}}" href="#AsteroidThermoPhysicalModels.thermal_radiance-Tuple{AsteroidShapeModels.ShapeModel, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, StaticArraysCore.StaticArray{Tuple{3}, &lt;:Real, 1}}"><code>AsteroidThermoPhysicalModels.thermal_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_radiance(shape, emissivities, temperatures, obs) -&gt; L</code></pre><p>Calculate the radiance from the temperature distribution based on a shape model.</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>        : Shape model of an asteroid</li><li><code>emissivities</code> : Emissivity of each facet of the shape model [-]</li><li><code>temperatures</code> : Temperature of each facet of the shape model [K]</li><li><code>obs</code>          : Position vector of the observer in the same coordinate system as <code>shape</code> [m]</li></ul><p><strong>Return</strong></p><ul><li><code>L</code> : Radiance [W/m²]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermal_radiation.jl#L41-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_skin_depth-NTuple{4, Any}" href="#AsteroidThermoPhysicalModels.thermal_skin_depth-NTuple{4, Any}"><code>AsteroidThermoPhysicalModels.thermal_skin_depth</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_skin_depth(P, k, ρ, Cp) -&gt; l_2π</code></pre><p>Calculate the thermal skin depth for a periodic temperature variation.</p><p><strong>Arguments</strong></p><ul><li><code>P::Real</code>  : Period of thermal cycle [s]</li><li><code>k::Real</code>  : Thermal conductivity [W/m/K]</li><li><code>ρ::Real</code>  : Material density [kg/m³]</li><li><code>Cₚ::Real</code> : Heat capacity [J/kg/K]</li></ul><p><strong>Returns</strong></p><ul><li><code>l_2π::Real</code> : Thermal skin depth [m]</li></ul><p><strong>Mathematical Formula</strong></p><p>The thermal skin depth is defined as:</p><p class="math-container">\[l_{2\pi} = \sqrt{\frac{4\pi P k}{\rho C_p}}\]</p><p><strong>Physical Meaning</strong></p><ul><li>Represents the e-folding depth of temperature variations</li><li>Temperature amplitude decreases by factor e^(-2π) ≈ 0.0019 at this depth</li><li>Useful for determining computational domain depth</li></ul><p><strong>Reference</strong></p><ul><li>Rozitis &amp; Green (2011), MNRAS 415, 2042-2062</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/thermo_params.jl#L17-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!-NTuple{5, Any}" href="#AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!-NTuple{5, Any}"><code>AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tridiagonal_matrix_algorithm!(a, b, c, d, x)
tridiagonal_matrix_algorithm!(stpm::SingleAsteroidThermoPhysicalModel)</code></pre><p>Tridiagonal matrix algorithm to solve the heat conduction equation by the implicit (backward) Euler and Crank-Nicolson methods.</p><pre><code class="nohighlight hljs">| b₁ c₁ 0  ⋯  0   | | x₁ |   | d₁ |
| a₂ b₂ c₂ ⋯  0   | | x₂ |   | d₂ |
| 0  a₃ b₃ ⋯  0   | | x₃ | = | d₃ |
| ⋮  ⋮  ⋮  ⋱  cₙ₋₁| | ⋮  |   | ⋮  |
| 0  0  0  aₙ bₙ  | | xₙ |   | dₙ |</code></pre><p><strong>References</strong></p><ul><li>https://en.wikipedia.org/wiki/Tridiagonal<em>matrix</em>algorithm</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L449-L464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult, BinaryAsteroidThermoPhysicalModel, Integer}" href="#AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.BinaryAsteroidThermoPhysicalModelResult, BinaryAsteroidThermoPhysicalModel, Integer}"><code>AsteroidThermoPhysicalModels.update_TPM_result!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_TPM_result!(result::BinaryAsteroidThermoPhysicalModelResult, btpm::BinaryAsteroidThermoPhysicalModel, ephem, i_time::Integer)</code></pre><p>Save the results of TPM at the time step <code>i_time</code> to <code>result</code>.</p><p><strong>Arguments</strong></p><ul><li><code>result</code> : Output data format for <code>BinaryAsteroidThermoPhysicalModel</code></li><li><code>btpm</code>   : Thermophysical model for a binary asteroid</li><li><code>ephem</code>  : Ephemerides</li><li><code>i_time</code>     : Time step</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L512-L522">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult, SingleAsteroidThermoPhysicalModel, Integer}" href="#AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.SingleAsteroidThermoPhysicalModelResult, SingleAsteroidThermoPhysicalModel, Integer}"><code>AsteroidThermoPhysicalModels.update_TPM_result!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_TPM_result!(result::SingleAsteroidThermoPhysicalModelResult, stpm::SingleAsteroidThermoPhysicalModel, i_time::Integer)</code></pre><p>Save the results of TPM at the time step <code>i_time</code> to <code>result</code>.</p><p><strong>Arguments</strong></p><ul><li><code>result</code> : Output data format for <code>SingleAsteroidThermoPhysicalModel</code></li><li><code>stpm</code>   : Thermophysical model for a single asteroid</li><li><code>i_time</code> : Time step to save data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/TPM.jl#L480-L489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_all!-Tuple{BinaryAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T}" href="#AsteroidThermoPhysicalModels.update_flux_all!-Tuple{BinaryAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T}"><code>AsteroidThermoPhysicalModels.update_flux_all!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_all!(btpm::BinaryAsteroidTPM, r☉₁::StaticVector{3}, r₁₂::StaticVector{3}, R₁₂::StaticMatrix{3,3})</code></pre><p>Update all energy fluxes (solar, scattered, thermal radiation) to the surface for a binary asteroid. This is a convenience function that computes necessary coordinate transformations and calls individual flux update functions.</p><p><strong>Arguments</strong></p><ul><li><code>btpm::BinaryAsteroidTPM</code> : Thermophysical model for a binary asteroid</li><li><code>r☉₁::StaticVector{3}</code>    : Sun&#39;s position in the primary&#39;s body-fixed frame (NOT normalized) [m]</li><li><code>r₁₂::StaticVector{3}</code>    : Position vector of secondary&#39;s center in primary&#39;s frame [m]</li><li><code>R₁₂::StaticMatrix{3,3}</code>  : Rotation matrix from primary to secondary frame</li></ul><p><strong>Algorithm</strong></p><ol><li>Computes all necessary coordinate transformations</li><li>Updates solar flux considering eclipse (mutual shadowing)</li><li>Updates scattered light flux (self-heating)</li><li>Updates thermal radiation flux (self-heating)</li><li>Applies mutual heating between components</li></ol><p><strong>Notes</strong></p><ul><li>This function internally handles all coordinate transformations</li><li>Automatically respects SELF<em>SHADOWING, SELF</em>HEATING, MUTUAL<em>SHADOWING, and MUTUAL</em>HEATING flags</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L180-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_all!-Tuple{SingleAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.update_flux_all!-Tuple{SingleAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.update_flux_all!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_all!(stpm::SingleAsteroidTPM, r☉::StaticVector{3})</code></pre><p>Update all energy fluxes (solar, scattered, thermal radiation) to the surface for a single asteroid.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>r☉::StaticVector{3}</code>     : Sun&#39;s position in the asteroid-fixed frame (NOT normalized) [m]</li></ul><p><strong>Algorithm</strong></p><ol><li>Updates direct solar flux on all faces considering self-shadowing</li><li>Updates scattered sunlight flux from other faces (self-heating)</li><li>Updates thermal radiation flux from other faces (self-heating)</li></ol><p><strong>Notes</strong></p><ul><li>This is a convenience function that calls all individual flux update functions</li><li>Automatically respects SELF<em>SHADOWING and SELF</em>HEATING flags</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L156-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{BinaryAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{BinaryAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_flux_rad_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_rad_single!(btpm::BinaryAsteroidTPM)</code></pre><p>Update flux of absorption of thermal radiation from surrounding surface. Single radiation-absorption is only considered, assuming albedo is close to zero at thermal infrared wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L423-L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_flux_rad_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_rad_single!(stpm::SingleAsteroidTPM)</code></pre><p>Update flux of absorption of thermal radiation from surrounding surface. Single radiation-absorption is only considered, assuming albedo is close to zero at thermal infrared wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L393-L401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{BinaryAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{BinaryAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_flux_scat_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_scat_single!(btpm::BinaryAsteroidTPM)</code></pre><p>Update flux of scattered sunlight, only considering single scattering.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L367-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_flux_scat_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_scat_single!(stpm::SingleAsteroidTPM)</code></pre><p>Update flux of scattered sunlight, only considering single scattering.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L340-L347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{BinaryAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T}" href="#AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{BinaryAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T, StaticArraysCore.StaticArray{Tuple{3, 3}, T, 2} where T}"><code>AsteroidThermoPhysicalModels.update_flux_sun!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_sun!(
    btpm::BinaryAsteroidTPM,
    r☉₁::StaticVector{3},   r☉₂::StaticVector{3}, 
    r₁₂::StaticVector{3},   r₂₁::StaticVector{3},
    R₁₂::StaticMatrix{3,3}, R₂₁::StaticMatrix{3,3},
)</code></pre><p>Update solar irradiation flux on both components of a binary asteroid system with mutual shadowing.</p><p><strong>Arguments</strong></p><ul><li><code>btpm::BinaryAsteroidTPM</code> : Thermophysical model for a binary asteroid</li><li><code>r☉₁::StaticVector{3}</code>    : Sun&#39;s position vector in the primary&#39;s body-fixed frame (NOT normalized) [m]</li><li><code>r☉₂::StaticVector{3}</code>    : Sun&#39;s position vector in the secondary&#39;s body-fixed frame (NOT normalized) [m]</li><li><code>r₁₂::StaticVector{3}</code>    : Position vector of secondary&#39;s center in primary&#39;s frame [m]</li><li><code>r₂₁::StaticVector{3}</code>    : Position vector of primary&#39;s center in secondary&#39;s frame [m]</li><li><code>R₁₂::StaticMatrix{3,3}</code>  : Rotation matrix from primary to secondary frame</li><li><code>R₂₁::StaticMatrix{3,3}</code>  : Rotation matrix from secondary to primary frame</li></ul><p><strong>Notes</strong></p><ul><li>All coordinate transformations should be pre-computed by the caller</li><li>Uses the new <code>apply_eclipse_shadowing!</code> API from AsteroidShapeModels.jl v0.4.1</li><li>Requires BVH to be built for both shapes (should be done when loading with <code>with_bvh=true</code>)</li><li>Combines self-shadowing and mutual shadowing in a single call</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L275-L299">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{SingleAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{SingleAsteroidThermoPhysicalModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.update_flux_sun!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_sun!(stpm::SingleAsteroidTPM, r☉::StaticVector{3})</code></pre><p>Update the direct solar irradiation flux on every face of the asteroid.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>r☉::StaticVector{3}</code>     : Position vector from asteroid to Sun in body-fixed frame (NOT normalized) [m]</li></ul><p><strong>Algorithm</strong></p><p>For each face, the solar flux is calculated as:</p><ol><li>Solar flux at asteroid&#39;s location: F☉ = SOLAR_CONST / distance²</li><li>Normalize sun direction: r̂☉ = r☉ / |r☉|</li><li>Face flux: F_sun = F☉ × max(0, n̂ · r̂☉)</li></ol><p>where n̂ is the face normal. If <code>SELF_SHADOWING</code> is enabled, the function also checks whether each face is shadowed by other parts of the asteroid.</p><p><strong>Notes</strong></p><ul><li>The input vector <code>r☉</code> must not be normalized (used for distance calculation)</li><li>Faces with negative dot product (facing away from Sun) receive zero flux</li><li>Shadowed faces (when <code>SELF_SHADOWING = true</code>) also receive zero flux</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/energy_flux.jl#L222-L244">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_lower_temperature!-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_lower_temperature!-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_lower_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_lower_temperature!(stpm::SingleAsteroidTPM)</code></pre><p>Update the temperature at the lower boundary (deepest layer) based on the boundary condition.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Boundary Conditions</strong></p><p>The function applies one of the following boundary conditions at the bottom of the computational domain:</p><ol><li><p><strong>Insulation (Neumann)</strong>: <code>∂T/∂z = 0</code></p><ul><li>No heat flux through the lower boundary</li><li>Temperature gradient is zero: <code>T[end] = T[end-1]</code></li><li>Most commonly used for asteroid modeling</li></ul></li><li><p><strong>Isothermal (Dirichlet)</strong>: <code>T = T_iso</code></p><ul><li>Fixed temperature at the lower boundary</li><li>Used when deep interior temperature is known</li><li><code>T[end] = stpm.BC_LOWER.T_iso</code></li></ul></li></ol><p><strong>Notes</strong></p><ul><li>This function is called after solving the heat conduction equation</li><li>For explicit Euler method, it directly updates the temperature vector</li><li>The lower boundary should be deep enough that the chosen condition doesn&#39;t affect surface temperatures</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L569-L594">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_surface_temperature!-Tuple{AbstractVector, Vararg{Float64, 6}}" href="#AsteroidThermoPhysicalModels.update_surface_temperature!-Tuple{AbstractVector, Vararg{Float64, 6}}"><code>AsteroidThermoPhysicalModels.update_surface_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_surface_temperature!(T::AbstractVector, F_abs::Real, k::Real, ρ::Real, Cₚ::Real, ε::Real, Δz::Real)</code></pre><p>Newton&#39;s method to update the surface temperature under radiation boundary condition.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>       : 1-D array of temperatures</li><li><code>F_abs</code>   : Total energy flux absorbed by the facet</li><li><code>k</code>       : Thermal conductivity [W/m/K]</li><li><code>ρ</code>       : Density [kg/m³]</li><li><code>Cₚ</code>      : Heat capacity [J/kg/K]</li><li><code>ε</code>       : Emissivity [-]</li><li><code>Δz</code>      : Depth step width [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L527-L540">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_temperature!-Tuple{BinaryAsteroidThermoPhysicalModel, Any}" href="#AsteroidThermoPhysicalModels.update_temperature!-Tuple{BinaryAsteroidThermoPhysicalModel, Any}"><code>AsteroidThermoPhysicalModels.update_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_temperature!(btpm::BinaryAsteroidTPM, Δt)</code></pre><p>Calculate the temperature for the next time step based on 1D heat conductivity equation.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>Δt</code>   : Time step [sec]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L114-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Any}" href="#AsteroidThermoPhysicalModels.update_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Any}"><code>AsteroidThermoPhysicalModels.update_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_temperature!(stpm::SingleAsteroidTPM, Δt)</code></pre><p>Update the temperature distribution for the next time step by solving the 1D heat conduction equation. The solver method is determined by <code>stpm.SOLVER</code>, and special handling is applied for zero conductivity.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li><li><code>Δt::Real</code> : Time step [s]</li></ul><p><strong>Solver Selection</strong></p><p>The function automatically selects the appropriate solver based on <code>stpm.SOLVER</code>:</p><ul><li><code>ExplicitEulerSolver</code>: Forward Euler method (conditionally stable, requires λ &lt; 0.5)</li><li><code>ImplicitEulerSolver</code>: Backward Euler method (unconditionally stable)</li><li><code>CrankNicolsonSolver</code>: Crank-Nicolson method (unconditionally stable, second-order accurate)</li></ul><p><strong>Special Cases</strong></p><ul><li>If thermal conductivity is zero, calls <code>update_temperature_zero_conductivity!</code> instead</li><li>The zero-conductivity case uses instantaneous radiative equilibrium</li></ul><p><strong>Mathematical Background</strong></p><p>Solves the 1D heat conduction equation:</p><pre><code class="nohighlight hljs">∂T/∂t = α ∂²T/∂z²</code></pre><p>where α = k/(ρCₚ) is the thermal diffusivity.</p><p><strong>See Also</strong></p><ul><li><code>explicit_euler!</code>, <code>implicit_euler!</code>, <code>crank_nicolson!</code> for specific solver implementations</li><li><code>update_temperature_zero_conductivity!</code> for the zero-conductivity case</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L63-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_temperature_zero_conductivity!-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_temperature_zero_conductivity!-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_temperature_zero_conductivity!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_temperature_zero_conductivity!(stpm::SingleAsteroidTPM)</code></pre><p>Update surface temperature for the zero thermal conductivity case. When thermal conductivity is zero, there is no heat conduction into the subsurface, and the surface temperature is determined solely by instantaneous radiative equilibrium.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Mathematical Formula</strong></p><p>For each face, the surface temperature T is calculated from:</p><pre><code class="nohighlight hljs">εσT⁴ = (1-Rᵥᵢₛ)F_sun + (1-Rᵥᵢₛ)F_scat + (1-Rᵢᵣ)F_rad</code></pre><p>where:</p><ul><li>ε : Emissivity</li><li>σ : Stefan-Boltzmann constant</li><li>Rᵥᵢₛ : Reflectance in visible light</li><li>Rᵢᵣ : Reflectance in thermal infrared</li><li>F_sun : Direct solar flux</li><li>F_scat : Scattered light flux</li><li>F_rad : Thermal radiation flux from surrounding surfaces</li></ul><p><strong>Notes</strong></p><ul><li>This function is called when <code>stpm.thermo_params.thermal_conductivity</code> is zero</li><li>The temperature instantly adjusts to balance incoming and outgoing radiation</li><li>No subsurface temperatures are updated (only surface layer)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L18-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{BinaryAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{BinaryAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_thermal_force!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_thermal_force!(btpm::BinaryAsteroidTPM)</code></pre><p>Calculate the thermal force and torque on every face and integrate them over all faces.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/non_grav.jl#L107-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{SingleAsteroidThermoPhysicalModel}" href="#AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{SingleAsteroidThermoPhysicalModel}"><code>AsteroidThermoPhysicalModels.update_thermal_force!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_thermal_force!(stpm::SingleAsteroidTPM)</code></pre><p>Calculate the thermal recoil force (Yarkovsky effect) and torque (YORP effect) on the asteroid by integrating photon momentum from thermal emission and reflection over all surface facets.</p><p><strong>Arguments</strong></p><ul><li><code>stpm::SingleAsteroidTPM</code> : Thermophysical model for a single asteroid</li></ul><p><strong>Physics</strong></p><p>The function calculates non-gravitational effects caused by anisotropic photon emission:</p><ul><li><strong>Yarkovsky effect</strong>: Net force due to thermal lag causing asymmetric emission</li><li><strong>YORP effect</strong>: Net torque changing the asteroid&#39;s rotation state</li></ul><p><strong>Algorithm</strong></p><p>For each facet i, the thermal force is computed as:</p><pre><code class="nohighlight hljs">F_i = -(2/3) × (E_i × A_i)/c × n̂_i + Σⱼ (E_i × A_i)/c × f_ij × d̂_ij</code></pre><p>where:</p><ul><li>E_i = total emittance from facet i (reflection + thermal emission) [W/m²]</li><li>A_i = area of facet i [m²]</li><li>c = speed of light [m/s]</li><li>n̂_i = outward normal vector of facet i</li><li>f_ij = view factor from facet i to j</li><li>d̂_ij = unit vector from facet i to j</li></ul><p>The first term represents direct photon recoil normal to the surface. The second term accounts for photons intercepted by other facets (self-heating contribution).</p><p><strong>Outputs (stored in stpm)</strong></p><ul><li><code>stpm.face_forces</code> : Thermal force vector on each facet [N]</li><li><code>stpm.force</code> : Total thermal force in body-fixed frame [N]</li><li><code>stpm.torque</code> : Total thermal torque in body-fixed frame [N⋅m]</li></ul><p><strong>Physical Significance</strong></p><ul><li>The force causes orbital drift (Yarkovsky effect)</li><li>The torque changes rotation period and obliquity (YORP effect)</li><li>Both effects are crucial for asteroid orbital evolution</li></ul><p><strong>References</strong></p><ul><li>Bottke Jr, W. F., et al. (2006). The Yarkovsky and YORP effects</li><li>Rozitis, B., &amp; Green, S. F. (2012). The influence of rough surface thermal-infrared beaming</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/non_grav.jl#L15-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_upper_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Integer}" href="#AsteroidThermoPhysicalModels.update_upper_temperature!-Tuple{SingleAsteroidThermoPhysicalModel, Integer}"><code>AsteroidThermoPhysicalModels.update_upper_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_upper_temperature!(stpm::SingleAsteroidTPM, i::Integer)</code></pre><p>Update the temperature of the upper surface based on the boundary condition <code>stpm.BC_UPPER</code>.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>i</code>    : Index of the face of the shape model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/62cb919ee42d43c05e4cf66b0b1b2f7631f419f2/src/heat_conduction.jl#L489-L497">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../benchmarks/">« Performance</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 17 July 2025 10:55">Thursday 17 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
