<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · AsteroidThermoPhysicalModels.jl</title><meta name="title" content="API · AsteroidThermoPhysicalModels.jl"/><meta property="og:title" content="API · AsteroidThermoPhysicalModels.jl"/><meta property="twitter:title" content="API · AsteroidThermoPhysicalModels.jl"/><meta name="description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="twitter:description" content="Documentation for AsteroidThermoPhysicalModels.jl."/><meta property="og:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><meta property="twitter:url" content="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><link rel="canonical" href="https://Astroshaper.github.io/AsteroidThermoPhysicalModels.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AsteroidThermoPhysicalModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../physical_model/">Physical model</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BackwardEulerSolver" href="#AsteroidThermoPhysicalModels.BackwardEulerSolver"><code>AsteroidThermoPhysicalModels.BackwardEulerSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the backward Euler method:</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>First order in time</li></ul><p>The <code>BackwardEulerSolver</code> type has vectors for the tridiagonal matrix algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryTPM" href="#AsteroidThermoPhysicalModels.BinaryTPM"><code>AsteroidThermoPhysicalModels.BinaryTPM</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BinaryTPM{M1, M2} &lt;: ThermoPhysicalModel</code></pre><p><strong>Fields</strong></p><ul><li><code>pri</code>              : TPM for the primary</li><li><code>sec</code>              : TPM for the secondary</li><li><code>MUTUAL_SHADOWING</code> : Flag to consider mutual shadowing</li><li><code>MUTUAL_HEATING</code>   : Flag to consider mutual heating</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L186-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryTPM-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.BinaryTPM-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.BinaryTPM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BinaryTPM(pri, sec; MUTUAL_SHADOWING=true, MUTUAL_HEATING=true) -&gt; btpm</code></pre><p>Construct a thermophysical model for a binary asteroid (<code>BinaryTPM</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L204-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryTPMResult" href="#AsteroidThermoPhysicalModels.BinaryTPMResult"><code>AsteroidThermoPhysicalModels.BinaryTPMResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct BinaryTPMResult</code></pre><p>Output data format for <code>BinaryTPM</code></p><p><strong>Fields</strong></p><ul><li><code>pri</code> : TPM result for the primary</li><li><code>sec</code> : TPM result for the secondary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L310-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BinaryTPMResult-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.BinaryTPMResult-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.BinaryTPMResult</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Outer constructor of <code>BinaryTPMResult</code></p><p><strong>Arguments</strong></p><ul><li><code>btpm</code>          : Thermophysical model for a binary asteroid</li><li><code>ephem</code>         : Ephemerides</li><li><code>times_to_save</code> : Timesteps to save temperature (Common to both the primary and the secondary)</li><li><code>face_ID_pri</code>   : Face indices to save subsurface temperature of the primary</li><li><code>face_ID_sec</code>   : Face indices to save subsurface temperature of the secondary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L325-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.BoundaryCondition" href="#AsteroidThermoPhysicalModels.BoundaryCondition"><code>AsteroidThermoPhysicalModels.BoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of a boundary condition for a heat conduction equation</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L72-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.CrankNicolsonSolver" href="#AsteroidThermoPhysicalModels.CrankNicolsonSolver"><code>AsteroidThermoPhysicalModels.CrankNicolsonSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the Crank-Nicolson method:</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>Second order in time</li></ul><p>The <code>CrankNicolsonSolver</code> type has vectors for the tridiagonal matrix algorithm.</p><p><strong>References</strong></p><ul><li>https://en.wikipedia.org/wiki/Crank–Nicolson_method</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L46-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ForwardEulerSolver" href="#AsteroidThermoPhysicalModels.ForwardEulerSolver"><code>AsteroidThermoPhysicalModels.ForwardEulerSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of the forward Euler method:</p><ul><li>Explicit in time</li><li>First order in time</li></ul><p>The <code>ForwardEulerSolver</code> type includes a vector for the temperature at the next time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L12-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.HeatConductionSolver" href="#AsteroidThermoPhysicalModels.HeatConductionSolver"><code>AsteroidThermoPhysicalModels.HeatConductionSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of a solver for a heat conduction equation </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.InsulationBoundaryCondition" href="#AsteroidThermoPhysicalModels.InsulationBoundaryCondition"><code>AsteroidThermoPhysicalModels.InsulationBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singleton type of insulation boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L84-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.IsothermalBoundaryCondition" href="#AsteroidThermoPhysicalModels.IsothermalBoundaryCondition"><code>AsteroidThermoPhysicalModels.IsothermalBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type of isothermal boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L90-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.RadiationBoundaryCondition" href="#AsteroidThermoPhysicalModels.RadiationBoundaryCondition"><code>AsteroidThermoPhysicalModels.RadiationBoundaryCondition</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Singleton type of radiation boundary condition</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L78-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ShapeModel" href="#AsteroidThermoPhysicalModels.ShapeModel"><code>AsteroidThermoPhysicalModels.ShapeModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ShapeModel</code></pre><p>A polyhedral shape model of an asteroid.</p><p><strong>Fields</strong></p><ul><li><code>nodes</code>         : Vector of node positions</li><li><code>faces</code>         : Vector of vertex indices of faces</li><li><code>face_centers</code>  : Center position of each face</li><li><code>face_normals</code>  : Normal vector of each face</li><li><code>face_areas</code>    : Area of of each face</li><li><code>visiblefacets</code> : Vector of vector of <code>VisibleFacet</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L21-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleTPM" href="#AsteroidThermoPhysicalModels.SingleTPM"><code>AsteroidThermoPhysicalModels.SingleTPM</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SingleTPM &lt;: ThermoPhysicalModel</code></pre><p><strong>Fields</strong></p><ul><li><p><code>shape</code>          : Shape model</p></li><li><p><code>thermo_params</code>  : Thermophysical parameters</p></li><li><p><code>flux</code>           : Flux on each face. Matrix of size (Number of faces, 3). Three components are:</p><ul><li><code>flux[:, 1]</code>     : F_sun,  flux of direct sunlight</li><li><code>flux[:, 2]</code>     : F_scat, flux of scattered light</li><li><code>flux[:, 3]</code>     : F_rad,  flux of thermal emission from surrounding surface</li></ul></li><li><p><code>temperature</code>    : Temperature matrix <code>(n_depth, n_face)</code> according to the number of depth cells <code>n_depth</code> and the number of faces <code>n_face</code>.</p></li><li><p><code>face_forces</code>    : Thermal force on each face</p></li><li><p><code>force</code>          : Thermal recoil force at body-fixed frame (Yarkovsky effect)</p></li><li><p><code>torque</code>         : Thermal recoil torque at body-fixed frame (YORP effect)</p></li><li><p><code>SELF_SHADOWING</code> : Flag to consider self-shadowing</p></li><li><p><code>SELF_HEATING</code>   : Flag to consider self-heating</p></li><li><p><code>SOLVER</code>         : Solver of heat conduction equation</p></li><li><p><code>BC_UPPER</code>       : Boundary condition at the upper boundary</p></li><li><p><code>BC_LOWER</code>       : Boundary condition at the lower boundary</p></li></ul><p><strong>TODO:</strong></p><ul><li>roughness_maps   ::ShapeModel[]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L109-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleTPM-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.SingleTPM-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.SingleTPM</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SingleTPM(shape, thermo_params; SELF_SHADOWING=true, SELF_HEATING=true) -&gt; stpm</code></pre><p>Construct a thermophysical model for a single asteroid (<code>SingleTPM</code>).</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>          : Shape model</li><li><code>thermo_params</code>  : Thermophysical parameters</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>SELF_SHADOWING</code> : Flag to consider self-shadowing</li><li><code>SELF_HEATING</code>   : Flag to consider self-heating</li><li><code>SOLVER</code>         : Solver of heat conduction equation</li><li><code>BC_UPPER</code>       : Boundary condition at the upper boundary</li><li><code>BC_LOWER</code>       : Boundary condition at the lower boundary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L154-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleTPMResult" href="#AsteroidThermoPhysicalModels.SingleTPMResult"><code>AsteroidThermoPhysicalModels.SingleTPMResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SingleTPMResult</code></pre><p>Output data format for <code>SingleTPM</code> </p><p><strong>Fields</strong></p><p><strong>Saved at all time steps</strong></p><ul><li><code>times</code>  : Timesteps, given the same vector as <code>ephem.time</code> [s]</li><li><code>E_in</code>   : Input energy per second on the whole surface [W]</li><li><code>E_out</code>  : Output enegey per second from the whole surface [W]</li><li><code>E_cons</code> : Energy conservation ratio [-], ratio of total energy going out to total energy coming in in the last rotation cycle</li><li><code>force</code>  : Thermal force on the asteroid [N]</li><li><code>torque</code> : Thermal torque on the asteroid [N ⋅ m]</li></ul><p><strong>Saved only at the time steps desired by the user</strong></p><ul><li><code>times_to_save</code>          : Timesteps to save temperature and thermal force on every face [s]</li><li><code>depth_nodes</code>            : Depths of the calculation nodes for 1-D heat conduction [m], a vector of size <code>n_depth</code></li><li><code>surface_temperature</code>    : Surface temperature [K], a matrix in size of <code>(n_face, n_time)</code>.<ul><li><code>n_face</code> : Number of faces</li><li><code>n_time</code> : Number of time steps to save surface temperature</li></ul></li><li><code>subsurface_temperature</code> : Temperature [K] as a function of depth [m] and time [s], <code>Dict</code> with face ID as key and a matrix <code>(n_depth, n_time)</code> as an entry.<ul><li><code>n_depth</code> : The number of the depth nodes</li><li><code>n_time</code> : The number of time steps to save temperature</li></ul></li><li><code>face_forces</code>            : Thermal force on every face of the shape model [N], a matrix in size of <code>(n_face, n_time)</code>.<ul><li><code>n_face</code> : Number of faces</li><li><code>n_time</code> : Number of time steps to save surface temperature</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L224-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.SingleTPMResult-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any, Vector{Float64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.SingleTPMResult-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any, Vector{Float64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.SingleTPMResult</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Outer constructor of <code>SingleTPMResult</code></p><p><strong>Arguments</strong></p><ul><li><code>stpm</code>          : Thermophysical model for a single asteroid</li><li><code>ephem</code>         : Ephemerides</li><li><code>times_to_save</code> : Timesteps to save temperature</li><li><code>face_ID</code>       : Face indices to save subsurface temperature</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L267-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ThermoParams" href="#AsteroidThermoPhysicalModels.ThermoParams"><code>AsteroidThermoPhysicalModels.ThermoParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct ThermoParams</code></pre><p><strong>Fields</strong></p><ul><li><p><code>period</code>          : Period of thermal cycle (rotation period) [sec]</p></li><li><p><code>skindepth</code>       : Vector of thermal skin depth for each facet [m]</p></li><li><p><code>inertia</code>         : Vector of thermal inertia for each facet [thermal inertia unit (tiu)]</p></li><li><p><code>reflectance_vis</code> : Vector of reflectance in visible light for each facet [-]</p></li><li><p><code>reflectance_ir</code>  : Vector of reflectance in thermal infrared for each facet [-]</p></li><li><p><code>emissivity</code>      : Vector of emissivity for each facet [-]</p></li><li><p><code>z_max</code>   : Depth of the lower boundary of a heat conduction equation [m]</p></li><li><p><code>Δz</code>      : Depth step width [m]</p></li><li><p><code>n_depth</code> : Number of depth steps</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermo_params.jl#L42-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.ThermoPhysicalModel" href="#AsteroidThermoPhysicalModels.ThermoPhysicalModel"><code>AsteroidThermoPhysicalModels.ThermoPhysicalModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Abstract type of a thermophysical model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L103-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.VisibleFacet" href="#AsteroidThermoPhysicalModels.VisibleFacet"><code>AsteroidThermoPhysicalModels.VisibleFacet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct VisibleFacet</code></pre><p>Index of an interfacing facet and its view factor</p><p><strong>Fields</strong></p><ul><li><code>id</code> : Index of the interfacing facet</li><li><code>f</code>  : View factor from facet i to j</li><li><code>d</code>  : Distance from facet i to j</li><li><code>d̂</code>  : Normal vector from facet i to j</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.backward_euler!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}" href="#AsteroidThermoPhysicalModels.backward_euler!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}"><code>AsteroidThermoPhysicalModels.backward_euler!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">backward_euler!(stpm::SingleTPM, Δt)</code></pre><p>Predict the temperature at the next time step by the backward Euler method.</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>First order in time</li><li>Second order in space</li></ul><p>In this function, the heat conduction equation is non-dimensionalized in time and length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L104-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.blackbody_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blackbody_radiance(λ, T) -&gt; L_λ</code></pre><p>Accroding to Planck&#39;s law, calculate the spectral intensity of blackbody radiation at wavelength <code>λ</code> and temperature <code>T</code>.</p><p><strong>Arguments</strong></p><ul><li><code>λ</code> : Wavelength [m]</li><li><code>T</code> : Temperature [K]</li></ul><p><strong>Return</strong></p><ul><li><code>L_λ</code> : Spectral radiance [W/m²/m/steradian]</li></ul><p>cf. https://github.com/JuliaAstro/Planck.jl/blob/main/src/Planck.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermal_radiation.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any}" href="#AsteroidThermoPhysicalModels.blackbody_radiance-Tuple{Any}"><code>AsteroidThermoPhysicalModels.blackbody_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blackbody_radiance(T) -&gt; L</code></pre><p>According to Stefan-Boltzmann law, calculate the total radiance of blackbody radiation at temperature <code>T</code>, integrated over all wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>T</code> : Temperature [K]</li></ul><p><strong>Return</strong></p><ul><li><code>L</code> : Radiance [W/m²/steradian]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermal_radiation.jl#L18-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.concave_spherical_segment-NTuple{6, Real}" href="#AsteroidThermoPhysicalModels.concave_spherical_segment-NTuple{6, Real}"><code>AsteroidThermoPhysicalModels.concave_spherical_segment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concave_spherical_segment(r, h, xc, yc, x, y) -&gt; z</code></pre><p>Return the z-coordinate of a concave spherical segment.</p><p><strong>Arguments</strong></p><ul><li><code>r</code> : Crater radius</li><li><code>h</code> : Crater depth</li><li><code>xc</code>: x-coordinate of crater center</li><li><code>yc</code>: y-coordinate of crater center</li><li><code>x</code> : x-coordinate where to calculate z</li><li><code>y</code> : y-coordinate where to calculate z</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/roughness.jl#L18-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.concave_spherical_segment-Tuple{Real, Real}" href="#AsteroidThermoPhysicalModels.concave_spherical_segment-Tuple{Real, Real}"><code>AsteroidThermoPhysicalModels.concave_spherical_segment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concave_spherical_segment(r, h; Nx=2^5, Ny=2^5, xc=0.5, yc=0.5) -&gt; xs, ys, zs</code></pre><p>Return (x, y, z) grid of a concave spherical segment.</p><p><strong>Arguments</strong></p><ul><li><code>r</code> : Crater radius</li><li><code>h</code> : Crater depth</li><li><code>Nx</code>: Number of nodes in the x-direction</li><li><code>Ny</code>: Number of nodes in the y-direction</li><li><code>xc</code>: x-coordinate of crater center</li><li><code>yc</code>: y-coordinate of crater center</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/roughness.jl#L44-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.crank_nicolson!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}" href="#AsteroidThermoPhysicalModels.crank_nicolson!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}"><code>AsteroidThermoPhysicalModels.crank_nicolson!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crank_nicolson!(stpm::SingleTPM, Δt)</code></pre><p>Predict the temperature at the next time step by the Crank-Nicolson method.</p><ul><li>Implicit in time (Unconditionally stable in the heat conduction equation)</li><li>Second order in time</li><li>Second order in space</li></ul><p>In this function, the heat conduction equation is non-dimensionalized in time and length.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L145-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.crater_curvature_radius-Tuple{Real, Real}" href="#AsteroidThermoPhysicalModels.crater_curvature_radius-Tuple{Real, Real}"><code>AsteroidThermoPhysicalModels.crater_curvature_radius</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crater_curvature_radius(r, h) -&gt; R</code></pre><p>Return the curvature radius of a concave spherical segment.</p><p><strong>Arguments</strong></p><ul><li><code>r</code>: Crater radius</li><li><code>h</code>: Crater depth</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/roughness.jl#L7-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.energy_in-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.energy_in-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.energy_in</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_in(stpm::SingleTPM) -&gt; E_in</code></pre><p>Input energy per second on the whole surface [W]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.energy_out-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.energy_out-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.energy_out</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_out(stpm::SingleTPM) -&gt; E_out</code></pre><p>Output enegey per second from the whole surface [W]</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L43-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.BinaryTPMResult}" href="#AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.BinaryTPMResult}"><code>AsteroidThermoPhysicalModels.export_TPM_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_TPM_results(dirpath, result::BinaryTPMResult)</code></pre><p>Export the result of <code>BinaryTPM</code> to CSV files.  The output files are saved in the following directory structure:</p><pre><code class="nohighlight hljs">dirpath
├── pri
│   ├── physical_quantities.csv
│   ├── subsurface_temperature.csv
│   ├── surface_temperature.csv
│   └── thermal_force.csv
└── sec
    ├── physical_quantities.csv
    ├── subsurface_temperature.csv
    ├── surface_temperature.csv
    └── thermal_force.csv</code></pre><p><strong>Arguments</strong></p><ul><li><code>dirpath</code> : Path to the directory to save CSV files.</li><li><code>result</code>  : Output data format for <code>BinaryTPM</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L487-L508">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.SingleTPMResult}" href="#AsteroidThermoPhysicalModels.export_TPM_results-Tuple{Any, AsteroidThermoPhysicalModels.SingleTPMResult}"><code>AsteroidThermoPhysicalModels.export_TPM_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_TPM_results(dirpath, result::SingleTPMResult)</code></pre><p>Export the result of <code>SingleTPM</code> to CSV files.  The output files are saved in the following directory structure:</p><pre><code class="nohighlight hljs">dirpath
├── physical_quantities.csv
├── subsurface_temperature.csv
├── surface_temperature.csv
└── thermal_force.csv</code></pre><p><strong>Arguments</strong></p><ul><li><code>dirpath</code> : Path to the directory to save CSV files.</li><li><code>result</code>  : Output data format for <code>SingleTPM</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L403-L418">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.find_visiblefacets!-Tuple{ShapeModel}" href="#AsteroidThermoPhysicalModels.find_visiblefacets!-Tuple{ShapeModel}"><code>AsteroidThermoPhysicalModels.find_visiblefacets!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_visiblefacets!(shape::ShapeModel; show_progress=true)</code></pre><p>Find facets that is visible from the facet where the observer is located.</p><p><strong>Arguments</strong></p><ul><li><code>shape</code> : Shape model of an asteroid</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>show_progress</code> : Switch to show a progress meter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/facet.jl#L83-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.flux_total-NTuple{5, Any}" href="#AsteroidThermoPhysicalModels.flux_total-NTuple{5, Any}"><code>AsteroidThermoPhysicalModels.flux_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flux_total(R_vis, R_ir, F_sun, F_scat, F_rad) -&gt; F_total</code></pre><p>Total energy absorbed by the surface [W/m²]</p><p><strong>Arguments</strong></p><ul><li><code>R_vis</code>  : Reflectance for visible light [-]</li><li><code>R_ir</code>   : Reflectance for thermal infrared [-]</li><li><code>F_sun</code>  : Flux of direct sunlight [W/m²]</li><li><code>F_scat</code> : Flux of scattered light [W/m²]</li><li><code>F_rad</code>  : Flux of thermal radiation from surrounding surface [W/m²]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L7-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.forward_euler!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}" href="#AsteroidThermoPhysicalModels.forward_euler!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}"><code>AsteroidThermoPhysicalModels.forward_euler!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward_euler!(stpm::SingleTPM, Δt)</code></pre><p>Predict the temperature at the next time step by the forward Euler method.</p><ul><li>Explicit in time</li><li>First order in time</li></ul><p>In this function, the heat conduction equation is non-dimensionalized in time and length.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>Δt</code>   : Time step [sec]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L50-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.grid_to_faces-Tuple{AbstractVector, AbstractVector, AbstractMatrix}" href="#AsteroidThermoPhysicalModels.grid_to_faces-Tuple{AbstractVector, AbstractVector, AbstractMatrix}"><code>AsteroidThermoPhysicalModels.grid_to_faces</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid_to_faces(xs::AbstractVector, ys::AbstractVector, zs::AbstractMatrix) -&gt; nodes, faces</code></pre><p>Convert a regular grid (x, y) and corresponding z-coordinates to triangular facets</p><pre><code class="nohighlight hljs">| ⧹| ⧹| ⧹|</code></pre><p>j+1 ・–C–D–・     |⧹ |⧹ |⧹ |     | ⧹| ⧹| ⧹| j   ・–A–B–・     |⧹ |⧹ |⧹ |        i  i+1</p><p><strong>Arguments</strong></p><ul><li><code>xs::AbstractVector</code> : x-coordinates of grid points (should be sorted)</li><li><code>ys::AbstractVector</code> : y-coordinates of grid points (should be sorted)</li><li><code>zs::AbstractMatrix</code> : z-coordinates of grid points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L93-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.init_temperature!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Real}" href="#AsteroidThermoPhysicalModels.init_temperature!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Real}"><code>AsteroidThermoPhysicalModels.init_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_temperature!(btpm::BinaryTPM, T₀::Real)</code></pre><p>Initialize all temperature cells at the given temperature <code>T₀</code></p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>T₀</code>   : Initial temperature of all cells [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L556-L564">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.init_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Real}" href="#AsteroidThermoPhysicalModels.init_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Real}"><code>AsteroidThermoPhysicalModels.init_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">init_temperature!(stpm::SingleTPM, T₀::Real)</code></pre><p>Initialize all temperature cells at the given temperature <code>T₀</code></p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>T₀</code>   : Initial temperature of all cells [K]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L542-L550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.isilluminated-Tuple{ShapeModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, Integer}" href="#AsteroidThermoPhysicalModels.isilluminated-Tuple{ShapeModel, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, Integer}"><code>AsteroidThermoPhysicalModels.isilluminated</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isilluminated(shape::ShapeModel, r☉::StaticVector{3}, i::Integer) -&gt; Bool</code></pre><p>Return if the <code>i</code>-th face of the <code>shape</code> model is illuminated by the direct sunlight or not</p><p><strong>Arguments</strong></p><ul><li><code>shape</code> : Shape model of an asteroid</li><li><code>r☉</code>    : Sun&#39;s position in the asteroid-fixed frame, which doesn&#39;t have to be normalized.</li><li><code>i</code>     : Index of the face to be checked</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/facet.jl#L165-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.load_shape_grid-Tuple{AbstractVector, AbstractVector, AbstractMatrix}" href="#AsteroidThermoPhysicalModels.load_shape_grid-Tuple{AbstractVector, AbstractVector, AbstractMatrix}"><code>AsteroidThermoPhysicalModels.load_shape_grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_shape_grid(xs, ys, zs; scale=1.0, find_visible_facets=false) -&gt; shape</code></pre><p>Convert a regular grid (x, y) to a shape model</p><p><strong>Arguments</strong></p><ul><li><code>xs::AbstractVector</code> : x-coordinates of grid points</li><li><code>ys::AbstractVector</code> : y-coordinates of grid points</li><li><code>zs::AbstractMatrix</code> : z-coordinates of grid points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L134-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.load_shape_obj-Tuple{Any}" href="#AsteroidThermoPhysicalModels.load_shape_obj-Tuple{Any}"><code>AsteroidThermoPhysicalModels.load_shape_obj</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_shape_obj(shapepath; scale=1.0, find_visible_facets=false; show_progress=true)</code></pre><p>Load a shape model from a Wavefront OBJ file.</p><p><strong>Arguments</strong></p><ul><li><code>shapepath</code> : Path to a Wavefront OBJ file</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>scale</code>               : Scale factor of the shape model</li><li><code>find_visible_facets</code> : Switch to find visible facets</li><li><code>show_progress</code>       : Switch to show a progress meter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L58-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.loadobj-Tuple{String}" href="#AsteroidThermoPhysicalModels.loadobj-Tuple{String}"><code>AsteroidThermoPhysicalModels.loadobj</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loadobj(shapepath::String; scale=1, message=true) -&gt; nodes, faces</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/obj.jl#L9-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.mutual_heating!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Any}" href="#AsteroidThermoPhysicalModels.mutual_heating!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Any}"><code>AsteroidThermoPhysicalModels.mutual_heating!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutual_heating!(btpm::BinaryTPM, rₛ, R₂₁)</code></pre><p>Calculate the mutual heating between the primary and secondary asteroids.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>rₛ</code>   : Position of the secondary relative to the primary (NOT normalized)</li><li><code>R₂₁</code>  : Rotation matrix from secondary to primary</li></ul><p><strong>TODO</strong></p><ul><li>Need to consider local horizon?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L381-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.mutual_shadowing!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Any, Any}" href="#AsteroidThermoPhysicalModels.mutual_shadowing!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Any, Any}"><code>AsteroidThermoPhysicalModels.mutual_shadowing!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutual_shadowing!(btpm::BinaryTPM, r☉, rₛ, R₂₁)</code></pre><p>Detect eclipse events between the primary and secondary, and update the solar fluxes of the faces.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>r☉</code>   : Position of the sun relative to the primary       (NOT normalized)</li><li><code>rₛ</code>   : Position of the secondary relative to the primary (NOT normalized)</li><li><code>R₂₁</code>  : Rotation matrix from secondary to primary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L237-L247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.polyhedron_volume-Tuple{Any, Any}" href="#AsteroidThermoPhysicalModels.polyhedron_volume-Tuple{Any, Any}"><code>AsteroidThermoPhysicalModels.polyhedron_volume</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polyhedron_volume(nodes, faces)      -&gt; vol
polyhedron_volume(shape::ShapeModel) -&gt; vol</code></pre><p>Calculate volume of a polyhedral</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/shape.jl#L165-L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.raycast-NTuple{4, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.raycast-NTuple{4, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.raycast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raycast(A, B, C, R) -&gt; Bool</code></pre><p>Intersection detection between ray R and triangle ABC. Note that the starting point of the ray is the origin (0, 0, 0).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/facet.jl#L51-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.raycast-NTuple{5, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.raycast-NTuple{5, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.raycast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">raycast(A, B, C, R, O) -&gt; Bool</code></pre><p>Intersection detection between ray R and triangle ABC. Use when the starting point of the ray is an arbitrary point <code>O</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/facet.jl#L74-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.run_TPM!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.run_TPM!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any, Vector{Float64}, Vector{Int64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.run_TPM!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_TPM!(btpm::BinaryTPM, ephem, savepath)</code></pre><p>Run TPM for a binary asteroid.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code>          : Thermophysical model for a binary asteroid</li><li><code>ephem</code>         : Ephemerides<ul><li><code>time</code> : Ephemeris times</li><li><code>sun1</code> : Sun&#39;s position in the primary&#39;s frame</li><li><code>sun2</code> : Sun&#39;s position in the secondary&#39;s frame</li><li><code>sec</code>  : Secondary&#39;s position in the primary&#39;s frame</li><li><code>P2S</code>  : Rotation matrix from primary to secondary frames</li><li><code>S2P</code>  : Rotation matrix from secondary to primary frames</li></ul></li><li><code>times_to_save</code> : Timesteps to save temperature</li><li><code>face_ID_pri</code>   : Face indices where to save subsurface termperature for the primary</li><li><code>face_ID_sec</code>   : Face indices where to save subsurface termperature for the secondary</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>show_progress</code> : Flag to show the progress meter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L673-L693">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.run_TPM!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any, Vector{Float64}, Vector{Int64}}" href="#AsteroidThermoPhysicalModels.run_TPM!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any, Vector{Float64}, Vector{Int64}}"><code>AsteroidThermoPhysicalModels.run_TPM!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_TPM!(stpm::SingleTPM, ephem, savepath)</code></pre><p>Run TPM for a single asteroid.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code>          : Thermophysical model for a single asteroid</li><li><code>ephem</code>         : Ephemerides<ul><li><code>ephem.time</code> : Ephemeris times</li><li><code>ephem.sun</code>  : Sun&#39;s position in the asteroid-fixed frame (Not normalized)</li></ul></li><li><code>times_to_save</code> : Timesteps to save temperature</li><li><code>face_ID</code>       : Face indices where to save subsurface termperature</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>show_progress</code> : Flag to show the progress meter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L619-L634">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.subsolar_temperature-Tuple{Any, AsteroidThermoPhysicalModels.AbstractThermoParams}" href="#AsteroidThermoPhysicalModels.subsolar_temperature-Tuple{Any, AsteroidThermoPhysicalModels.AbstractThermoParams}"><code>AsteroidThermoPhysicalModels.subsolar_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subsolar_temperature(r☉) -&gt; Tₛₛ</code></pre><p>Subsolar temperature [K] on an asteroid at a heliocentric distance <code>r☉</code> [m], assuming radiative equilibrium with zero conductivity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L526-L531">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.surface_temperature-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.surface_temperature-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.surface_temperature</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Return surface temperature of a single asteroid corrsponding to each face.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L214-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_inertia-Tuple{Any, Any, Any}" href="#AsteroidThermoPhysicalModels.thermal_inertia-Tuple{Any, Any, Any}"><code>AsteroidThermoPhysicalModels.thermal_inertia</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_inertia(k, ρ, Cp) -&gt; Γ</code></pre><p><strong>Arguments</strong></p><ul><li><code>k</code>  : Thermal conductivity [W/m/K]</li><li><code>ρ</code>  : Material density [kg/m³]</li><li><code>Cₚ</code> : Heat capacity [J/kg/K]</li></ul><p><strong>Return</strong></p><ul><li><code>Γ</code> : Thermal inertia [tiu (thermal intertia unit)]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermo_params.jl#L22-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_radiance-Tuple{ShapeModel, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, StaticArraysCore.StaticArray{Tuple{3}, &lt;:Real, 1}}" href="#AsteroidThermoPhysicalModels.thermal_radiance-Tuple{ShapeModel, AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}, StaticArraysCore.StaticArray{Tuple{3}, &lt;:Real, 1}}"><code>AsteroidThermoPhysicalModels.thermal_radiance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_radiance(shape, emissivities, temperatures, obs) -&gt; L</code></pre><p>Calculate the radiance from the temperature distribution based on a shape model.</p><p><strong>Arguments</strong></p><ul><li><code>shape</code>        : Shape model of an asteroid</li><li><code>emissivities</code> : Emissivity of each facet of the shape model [-]</li><li><code>temperatures</code> : Temperature of each facet of the shape model [K]</li><li><code>obs</code>          : Position vector of the observer in the same coordinate system as <code>shape</code> [m]</li></ul><p><strong>Return</strong></p><ul><li><code>L</code> : Radiance [W/m²]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermal_radiation.jl#L33-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.thermal_skin_depth-NTuple{4, Any}" href="#AsteroidThermoPhysicalModels.thermal_skin_depth-NTuple{4, Any}"><code>AsteroidThermoPhysicalModels.thermal_skin_depth</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thermal_skin_depth(P, k, ρ, Cp) -&gt; l_2π</code></pre><p><strong>Arguments</strong></p><ul><li><code>P</code>  : Cycle of thermal cycle [sec]</li><li><code>k</code>  : Thermal conductivity [W/m/K]</li><li><code>ρ</code>  : Material density [kg/m³]</li><li><code>Cₚ</code> : Heat capacity [J/kg/K]</li></ul><p><strong>Return</strong></p><ul><li><code>l_2π</code> : Thermal skin depth [m], as defined in Rozitis &amp; Green (2011).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/thermo_params.jl#L7-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!-NTuple{5, Any}" href="#AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!-NTuple{5, Any}"><code>AsteroidThermoPhysicalModels.tridiagonal_matrix_algorithm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tridiagonal_matrix_algorithm!(a, b, c, d, x)
tridiagonal_matrix_algorithm!(stpm::SingleTPM)</code></pre><p>Tridiagonal matrix algorithm to solve the heat conduction equation by the backward Euler and Crank-Nicolson methods.</p><pre><code class="nohighlight hljs">| b₁ c₁ 0  ⋯  0   | | x₁ |   | d₁ |
| a₂ b₂ c₂ ⋯  0   | | x₂ |   | d₂ |
| 0  a₃ b₃ ⋯  0   | | x₃ | = | d₃ |
| ⋮  ⋮  ⋮  ⋱  cₙ₋₁| | ⋮  |   | ⋮  |
| 0  0  0  aₙ bₙ  | | xₙ |   | dₙ |</code></pre><p><strong>References</strong></p><ul><li>https://en.wikipedia.org/wiki/Tridiagonal<em>matrix</em>algorithm</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L193-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.BinaryTPMResult, AsteroidThermoPhysicalModels.BinaryTPM, Integer}" href="#AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.BinaryTPMResult, AsteroidThermoPhysicalModels.BinaryTPM, Integer}"><code>AsteroidThermoPhysicalModels.update_TPM_result!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_TPM_result!(result::BinaryTPMResult, btpm::BinaryTPM, ephem, i_time::Integer)</code></pre><p>Save the results of TPM at the time step <code>i_time</code> to <code>result</code>.</p><p><strong>Arguments</strong></p><ul><li><code>result</code> : Output data format for <code>BinaryTPM</code></li><li><code>btpm</code>   : Thermophysical model for a binary asteroid</li><li><code>ephem</code>  : Ephemerides</li><li><code>i_time</code>     : Time step</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L386-L396">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.SingleTPMResult, AsteroidThermoPhysicalModels.SingleTPM, Integer}" href="#AsteroidThermoPhysicalModels.update_TPM_result!-Tuple{AsteroidThermoPhysicalModels.SingleTPMResult, AsteroidThermoPhysicalModels.SingleTPM, Integer}"><code>AsteroidThermoPhysicalModels.update_TPM_result!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_TPM_result!(result::SingleTPMResult, stpm::SingleTPM, i_time::Integer)</code></pre><p>Save the results of TPM at the time step <code>i_time</code> to <code>result</code>.</p><p><strong>Arguments</strong></p><ul><li><code>result</code> : Output data format for <code>SingleTPM</code></li><li><code>stpm</code>   : Thermophysical model for a single asteroid</li><li><code>i_time</code> : Time step to save data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/TPM.jl#L343-L352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}" href="#AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}"><code>AsteroidThermoPhysicalModels.update_flux_rad_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_rad_single!(btpm::BinaryTPM)</code></pre><p>Update flux of absorption of thermal radiation from surrounding surface. Single radiation-absorption is only considered, assuming albedo is close to zero at thermal infrared wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L217-L225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.update_flux_rad_single!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.update_flux_rad_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_rad_single!(stpm::SingleTPM)</code></pre><p>Update flux of absorption of thermal radiation from surrounding surface. Single radiation-absorption is only considered, assuming albedo is close to zero at thermal infrared wavelength.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L190-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}" href="#AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}"><code>AsteroidThermoPhysicalModels.update_flux_scat_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_scat_single!(btpm::BinaryTPM)</code></pre><p>Update flux of scattered sunlight, only considering single scattering.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L162-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.update_flux_scat_single!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.update_flux_scat_single!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_scat_single!(stpm::SingleTPM)</code></pre><p>Update flux of scattered sunlight, only considering single scattering.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L138-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.update_flux_sun!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_sun!(btpm::BinaryTPM, r☉₁::StaticVector{3}, r☉₂::StaticVector{3})</code></pre><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>r☉₁</code>  : Sun&#39;s position in the body-fixed frame of the primary, which is not normalized.</li><li><code>r☉₂</code>  : Sun&#39;s position in the body-fixed frame of the secondary, which is not normalized.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L120-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, Real}" href="#AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T, Real}"><code>AsteroidThermoPhysicalModels.update_flux_sun!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_sun!(stpm::SingleTPM, r̂☉::StaticVector{3}, F☉::Real)</code></pre><p>Update solar irradiation flux on every face of a shape model.</p><ul><li><code>shape</code> : Shape model</li><li><code>r̂☉</code>    : Normalized vector indicating the direction of the sun in the body-fixed frame</li><li><code>F☉</code>    : Solar radiation flux [W/m²]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L69-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}" href="#AsteroidThermoPhysicalModels.update_flux_sun!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, StaticArraysCore.StaticArray{Tuple{3}, T, 1} where T}"><code>AsteroidThermoPhysicalModels.update_flux_sun!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_flux_sun!(stpm::SingleTPM, r☉::StaticVector{3})</code></pre><p>Update solar irradiation flux on every face of a shape model.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>r☉</code>   : Position of the sun in the body-fixed frame (NOT normalized)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/energy_flux.jl#L103-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_lower_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.update_lower_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.update_lower_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_bottom_temperature!(shape::ShapeModel)</code></pre><p>Update the temperature of the bottom surface based on the boundary condition <code>stpm.BC_LOWER</code>.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code>       : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L302-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_surface_temperature!-Tuple{AbstractVector, Vararg{Float64, 6}}" href="#AsteroidThermoPhysicalModels.update_surface_temperature!-Tuple{AbstractVector, Vararg{Float64, 6}}"><code>AsteroidThermoPhysicalModels.update_surface_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_surface_temperature!(T::AbstractVector, F_total::Real, k::Real, l::Real, Δz::Real, ε::Real)</code></pre><p>Newton&#39;s method to update the surface temperature under radiation boundary condition.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>       : 1-D array of temperatures</li><li><code>F_total</code> : Total energy absorbed by the facet</li><li><code>Γ</code>       : Thermal inertia [tiu]</li><li><code>P</code>       : Period of thermal cycle [sec]</li><li><code>Δz̄</code>      : Non-dimensional step in depth, normalized by thermal skin depth <code>l</code></li><li><code>ε</code>       : Emissivity [-]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L268-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_temperature!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any}" href="#AsteroidThermoPhysicalModels.update_temperature!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM, Any}"><code>AsteroidThermoPhysicalModels.update_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_temperature!(btpm::BinaryTPM, Δt)</code></pre><p>Calculate the temperature for the next time step based on 1D heat conductivity equation.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li><li><code>Δt</code>   : Time step [sec]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L31-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}" href="#AsteroidThermoPhysicalModels.update_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Any}"><code>AsteroidThermoPhysicalModels.update_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_temperature!(stpm::SingleTPM, Δt)</code></pre><p>Calculate the temperature for the next time step based on 1D heat conduction equation. If the thermal inertia (conductivity) is zero, omit to solve the heat conduction equation. The surface termperature is determined only by radiative equilibrium.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>Δt</code>   : Time step [sec]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L7-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}" href="#AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{AsteroidThermoPhysicalModels.BinaryTPM}"><code>AsteroidThermoPhysicalModels.update_thermal_force!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_thermal_force!(btpm::BinaryTPM)</code></pre><p>Calculate the thermal force and torque on every face and integrate them over all faces.</p><p><strong>Arguments</strong></p><ul><li><code>btpm</code> : Thermophysical model for a binary asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/non_grav.jl#L54-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}" href="#AsteroidThermoPhysicalModels.update_thermal_force!-Tuple{AsteroidThermoPhysicalModels.SingleTPM}"><code>AsteroidThermoPhysicalModels.update_thermal_force!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_thermal_force!(stpm::SingleTPM)</code></pre><p>Calculate the thermal force and torque on every face and integrate them over all faces.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/non_grav.jl#L7-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.update_upper_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Integer}" href="#AsteroidThermoPhysicalModels.update_upper_temperature!-Tuple{AsteroidThermoPhysicalModels.SingleTPM, Integer}"><code>AsteroidThermoPhysicalModels.update_upper_temperature!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_upper_temperature!(stpm::SingleTPM, i::Integer)</code></pre><p>Update the temperature of the upper surface based on the boundary condition <code>stpm.BC_UPPER</code>.</p><p><strong>Arguments</strong></p><ul><li><code>stpm</code> : Thermophysical model for a single asteroid</li><li><code>i</code>    : Index of the face of the shape model</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/heat_conduction.jl#L232-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AsteroidThermoPhysicalModels.view_factor-NTuple{5, Any}" href="#AsteroidThermoPhysicalModels.view_factor-NTuple{5, Any}"><code>AsteroidThermoPhysicalModels.view_factor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">view_factor(cᵢ, cⱼ, n̂ᵢ, n̂ⱼ, aⱼ) -&gt; fᵢⱼ, dᵢⱼ, d̂ᵢⱼ</code></pre><p>View factor from facet i to j, assuming Lambertian emission.</p><ul><li><hr/></li><li>(i)   fᵢⱼ   (j)</li><li>△    –&gt;    △</li><li><hr/></li><li>cᵢ          cⱼ  : Center of each face</li><li>n̂ᵢ          n̂ⱼ  : Normal vector of each face</li><li><ul><li><pre><code class="nohighlight hljs">      aⱼ  : Area of j-th face</code></pre></li></ul></li><li><hr/></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Astroshaper/AsteroidThermoPhysicalModels.jl/blob/2d36b5a11849abc8cb8bd6b9e22fdf236f7a786e/src/facet.jl#L21-L34">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../physical_model/">« Physical model</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Friday 4 April 2025 13:55">Friday 4 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
